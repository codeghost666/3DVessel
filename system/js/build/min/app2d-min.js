!function e(t,o,i){function n(a,s){if(!o[a]){if(!t[a]){var l="function"==typeof require&&require;if(!s&&l)return l(a,!0);if(r)return r(a,!0);var d=new Error("Cannot find module '"+a+"'");throw d.code="MODULE_NOT_FOUND",d}var c=o[a]={exports:{}};t[a][0].call(c.exports,function(e){var o=t[a][1][e];return n(o?o:e)},c,c.exports,e,t,o,i)}return o[a].exports}for(var r="function"==typeof require&&require,a=0;a<i.length;a++)n(i[a]);return n}({1:[function(e,t,o){"use strict";var i=e("../core/vessels-2d.js"),n=e("../colors/colors-widget.js");window.VesselsApp2D=i.VesselsApp2D,window.appColorsWidget=n.ColorsWidget},{"../colors/colors-widget.js":2,"../core/vessels-2d.js":6}],2:[function(e,t,o){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(o,"__esModule",{value:!0});var n=function(){function e(e,t){for(var o=0;o<t.length;o++){var i=t[o];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,o,i){return o&&e(t.prototype,o),i&&e(t,i),t}}(),r=e("../utils/js-helpers.js"),a=e("../utils/dom-utilities.js"),s=e("../core/i18labels.js"),l=function(){function e(t,o){var n=arguments.length<=2||void 0===arguments[2]?null:arguments[2];i(this,e);var r=this;this.isOpened=!1,this.btn=t,this.referenz=n,this.filters=o||{},this._currentOption=null,this._node=function(){var e=void 0,i=void 0,n=void 0,l=void 0,d=void 0,c=void 0,h=void 0,u=void 0,v=void 0,p=[],f=void 0,g=void 0,m=void 0,b=void 0,y=void 0,T="colors-container-"+Math.round(1e5*Math.random());e=document.createElement("div"),e.className="colors-container",e.innerHTML="<h2>"+s.CLICK_TO_CHANGE_COLORS+"</h2>",e.id=T,f=document.createElement("div"),f.className="colors-container-top",i=document.createElement("SELECT"),i.id=T+"-dropdwn",f.appendChild(i),m=[];for(u in o)m.push({name:o[u].name,key:u});for(m=m.sort(function(e,t){return e.name>=t.name?1:-1}),b=0,y=m.length;y>b;b+=1)u=m[b].key,v=o[u],p.push("<option value='"+u+"'>"+v.name+"</option>");return i.innerHTML=p.join(""),l=document.createElement("button"),l.innerHTML="SAVE",f.appendChild(l),d=document.createElement("button"),d.innerHTML="CANCEL",f.appendChild(d),e.appendChild(f),n=document.createElement("ul"),n.className="colors-container-ulColors",n.id=T+"-ulColors",e.appendChild(n),c=document.createElement("div"),c.className="colors-container-colorPicker",c.id=T+"-colorPicker",e.appendChild(c),e.dropdwn=i,e.ulColors=n,e.colorPickerDiv=c,e.btnSave=l,e.btnCancel=d,e.colorsTemp={},document.body.appendChild(e),t&&(a.addEventLnr(t,"click",r.toggleHandler.bind(r)),a.addEventLnr(i,"change",r.dropFilterChanged.bind(r)),a.addEventLnr(d,"click",r.close.bind(r)),a.addEventLnr(l,"click",r.saveColors.bind(r)),a.addEventLnr(n,"click",r.selectOption.bind(r))),e}(),this.onToggled=null,this.onSaved=null,this.postUrl=null,this._jsonColors={}}return n(e,[{key:"mergeColorSettings",value:function t(e){var t=e,o=void 0,i=void 0,n=void 0,r=this.filters,a=void 0,l=void 0;if("String"==typeof e&&(t=JSON.parse(e)),!t.colors)return void console.warn(s.NO_COLOR_SETTINGS);for(o in t.colors)a=o.split("___"),r[a[0]]&&r[a[0]].obs.hasOwnProperty(a[1])&&(i=t.colors[o],r[a[0]].obs[a[1]].color=i,r[a[0]].obs[a[1]].hexColor=parseInt(i.replace(/^#/,""),16),r[a[0]].obs[a[1]].colorIsRandom=!1);this._jsonColors=t.colors}},{key:"toggleHandler",value:function o(e){this.toggle(!this.isOpened)}},{key:"close",value:function r(){this.toggle(!1)}},{key:"toggle",value:function l(){var e=arguments.length<=0||void 0===arguments[0]?!0:arguments[0],t=this.filters;return this._node.style.display=e?"block":"none",this.isOpened=e,e?(this._node.colorsTemp={},this.referenz&&""!==this.referenz.value&&t[this.referenz.value]&&(this._node.dropdwn.value=this.referenz.value),this.dropFilterChanged(),void(this.onToggled&&this.onToggled(!0))):void(this.onToggled&&this.onToggled(!1))}},{key:"_makeHeightVisible",value:function d(e){var t=Number(e),o=Math.floor(t),i=1.2*(t-o);return String(o+i).replace(".","'")+'"'}},{key:"dropFilterChanged",value:function c(){var e=this,t=[],o=void 0,i={0:"no",1:"yes"},n=this._node.dropdwn.value,r=this.filters[n],a=void 0,s=void 0,l=void 0,d=void 0,c=void 0,h=void 0,u=void 0;for(c=_.keys(r.obs).sort(),h=0,u=c.length;u>h;h+=1)o=c[h],l=e._node.colorsTemp[n+"___"+o]||r.obs[o].color,d="h"===n?e._makeHeightVisible(o):o,t.push("<li data-color='"+l+"' id='liColor_"+n+"___"+o+"'><span style='background:"+l+"'> </span>"+(r.tf?i[o]:d)+"&nbsp;</li>");this._node.ulColors.innerHTML=t.join(""),a=this._node.ulColors.getElementsByTagName("LI"),a&&0!==a.length&&(s=a[0],s.className="selected",this._currentOption=s,this._node.colorPickerJoe?this._node.colorPickerJoe.set(s.getAttribute("data-color")):(this._node.colorPickerJoe=colorjoe.rgb(this._node.colorPickerDiv,s.getAttribute("data-color")),this._node.colorPickerJoe.on("change",function(t){var o=e._currentOption.id.replace("liColor_","");e._currentOption.setAttribute("data-color",t.hex()),e._currentOption.getElementsByTagName("SPAN")[0].style.background=t.hex(),e._node.colorsTemp[o]=t.hex()})))}},{key:"selectOption",value:function h(e){var t=this,o=e.target,i=void 0,n=void 0,r=void 0;if("LI"===o.tagName&&(i=this._node.ulColors.getElementsByTagName("LI"),"selected"!==o.className)){for(n=0,r=i.length;r>n;n+=1)o!==i[n]&&(i[n].className="");setTimeout(function(){o.className="selected",t._node.colorPickerJoe.set(o.getAttribute("data-color"),!0),t._currentOption=o},150)}}},{key:"saveColors",value:function u(){var e=void 0,t=this._node.colorsTemp,o=this.filters,i={},n=[],r=void 0,a=void 0,s=void 0;for(e in t)r=e.split("___"),2===r.length&&(a=t[e],o[r[0]].obs[r[1]].color=a,o[r[0]].obs[r[1]].hexColor=parseInt(a.replace(/^#/,""),16),o[r[0]].obs[r[1]].colorIsRandom=!1,i[r[0]]||(i[r[0]]=!0),n.push({attributeKey:r[0],attributeValue:r[1],hexColor:a}));this.close(),this.onSaved&&this.onSaved(o,t,i),this.postUrl&&0!==n.length&&(s=new XMLHttpRequest,s.open("POST",this.postUrl),s.setRequestHeader("Content-Type","application/json"),s.onreadystatechange=function(){4===s.readyState&&200===s.status&&console.log(s.responseText)},s.send(JSON.stringify(n)))}},{key:"getColors",value:function v(){var e={},t=void 0,o=void 0,i=this.filters;for(t in i){e[t]={};for(o in i[t].obs)e[t][o]={color:i[t].obs[o].color,colorIsRandom:i[t].obs[o].colorIsRandom}}return e}}]),e}();o.ColorsWidget=l},{"../core/i18labels.js":4,"../utils/dom-utilities.js":7,"../utils/js-helpers.js":8}],3:[function(e,t,o){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(o,"__esModule",{value:!0});var n=function(){function e(e,t){for(var o=0;o<t.length;o++){var i=t[o];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,o,i){return o&&e(t.prototype,o),i&&e(t,i),t}}(),r=e("./i18labels.js"),a=e("../utils/js-helpers.js"),s=e("../utils/dom-utilities.js"),l=function(){function e(t){i(this,e),this.divLoading=t}return n(e,[{key:"loadUrl",value:function t(e){var t=arguments.length<=1||void 0===arguments[1]?"":arguments[1],o=arguments.length<=2||void 0===arguments[2]?null:arguments[2],i=this;return new Promise(function(n,a){function l(e){var t=void 0;try{200===d.status?(t=JSON.parse(d.responseText),n(t)):a(d.statusText)}catch(o){a(r.ERROR_PARSING_JSON+" "+o.description)}}var d=void 0,c=function u(e){i.divLoading&&(i.divLoading.setMessage(e.responseText,!0),i.divLoading.updateLoader(0,1)),console.error(e)},h=function v(e){if(e.lengthComputable){var t=e.loaded/e.total;i.divLoading.updateLoader(t,.5)}};return e?(i.divLoading&&(i.divLoading.show(),i.divLoading.startAnimation(),t&&i.divLoading.setMessage(t)),d=new XMLHttpRequest,s.addEventLnr(d,"load",l),s.addEventLnr(d,"error",c),(i.divLoading||null!==o)&&s.addEventLnr(d,"progress",o||h),d.open("GET",e+(e.indexOf("?")>0?"&":"?")+"t="+1*new Date),void d.send()):void a(r.INVALID_DATA_SOURCE)})}},{key:"generateStructuredData",value:function o(e){function t(e){var t=e.bay,o=e.iBay;o%2===0&&(t=a.pad(o-1,3)),j[e.bay]?j[e.bay]+=1:j[e.bay]=1,w[t]||(w[t]={cells:{},n:0},w.n+=1,w[t].maxD=20,S.push(t)),w[t].cells[e.cell]||(w[t].cells[e.cell]={tiers:{},n:0},w[t].n+=1,R||"00"!==e.cell||(R=!0)),w[t].cells[e.cell].tiers[e.tier]=e,w[t].cells[e.cell].n+=1,M<w[t].n&&(M=w[t].n),e.depth>w[t].maxD&&(w[t].maxD=e.depth),s.tier<"78"?(m.tiers[s.tier]||(m.tiers[s.tier]={h:e.h,accH:0},m.n+=1),e.h>m.tiers[s.tier].h&&(m.tiers[s.tier].h=e.h)):b.tiers[s.tier]||(b.tiers[s.tier]={h:e.h,accH:0},b.n+=1),g[s.tier]?g[s.tier].maxH=Math.max(g[s.tier].maxH,s.h):g[s.tier]={maxH:s.h}}function o(e,t,o){x[e]={name:t,obs:{},tf:o}}function i(e){x.s.obs[e.s]||(x.s.obs[e.s]={c:1,indexes:[]}),x.i.obs[e.i]||(x.i.obs[e.i]={c:1,indexes:[]}),x.r.obs[e.r]||(x.r.obs[e.r]={c:1,indexes:[]}),x.w.obs[e.w]||(x.w.obs[e.w]={c:1,indexes:[]}),x.o.obs[e.o]||(x.o.obs[e.o]={c:1,indexes:[]}),x.d.obs[e.d]||(x.d.obs[e.d]={c:1,indexes:[]}),x.f.obs[e.f]||(x.f.obs[e.f]={c:1,indexes:[]}),x.t.obs[e.t]||(x.t.obs[e.t]={c:1,indexes:[]}),x.x.obs[e.x]||(x.x.obs[e.x]={c:1,indexes:[]}),x.v.obs[e.v]||(x.v.obs[e.v]={c:1,indexes:[]}),x.l.obs[e.l]||(x.l.obs[e.l]={c:1,indexes:[]}),x.h.obs[e.h]||(x.h.obs[e.h]={c:1,indexes:[]}),x.s.obs[e.s].indexes.push(e),x.i.obs[e.i].indexes.push(e),x.r.obs[e.r].indexes.push(e),x.w.obs[e.w].indexes.push(e),x.o.obs[e.o].indexes.push(e),x.d.obs[e.d].indexes.push(e),x.f.obs[e.f].indexes.push(e),x.t.obs[e.t].indexes.push(e),x.x.obs[e.x].indexes.push(e),x.v.obs[e.v].indexes.push(e),x.l.obs[e.l].indexes.push(e),x.h.obs[e.h].indexes.push(e)}var n=void 0,r=void 0,s=void 0,l=void 0,d=void 0,c=void 0,h=0,u=0,v=0,p={},f={},g={},m=void 0,b=void 0,y=void 0,T=void 0,w=void 0,x=void 0,S=[],P=void 0,O=void 0,C=void 0,k=void 0,E=void 0,N=void 0,L=void 0,M=0,I="",R=!1,F=0,j={},A={},D={};if(T=e["3DVesselData"]||e["2DVesselData"],!T)return console.error("No data!. Halting generateStructuredData."),null;for(y={conts:T,info:{contsL:T.length}},w={n:0},m={n:0,tiers:{}},b={n:0,tiers:{}},x={},o("i","Equipment Type",!1),o("s","Is Full",!0),o("r","Is Reefer",!0),o("w","Is Hazardous",!0),o("t","Is Tank",!0),o("x","Is OOG",!0),o("o","Line Operator",!1),o("d","Port of Discharge",!1),o("f","Port of Load",!1),o("v","Is VGM Weight",!0),o("l","Length",!1),o("h","Height",!1),r=0,n=y.conts.length;n>r;r+=1)s=y.conts[r],s.bay=s.p.substr(0,3),s.cell=s.p.substr(3,2),s.tier=s.p.substr(5,2),s.h=Number(Math.floor(s.h))+5*(s.h-Math.floor(s.h))/6,s.depth=Number(Math.floor(s.l))+5*(s.l-Math.floor(s.l))/6,s.iBay=Number(s.bay),s.iTier=Number(s.tier),s.myJ=r,s.cDash=s.c.replace(/\s/gi,"-"),void 0===s.f&&void 0!==s.ld&&(s.f=s.ld),A["cont_"+s.cDash]=s,t(s),i(s);for(I=_.max(_.keys(w)),r=1,n=Number(I);n>=r;r+=2)P=a.pad(r,3),C=a.pad(r-1,3),w[P]&&(w[P].isBlockStart=!0,j[C]&&(w[P].isBlockStart=!1),w[P].maxCell=_.chain(w[P].cells).keys().sort().last().value());return k=Number(_.min(_.keys(m.tiers))),E=Number(_.min(_.keys(b.tiers))),N=Number(_.max(_.keys(m.tiers))),L=Number(_.max(_.keys(b.tiers))),{data:y,dataStructured:w,dataStructuredKeysArr:S.sort(a.sortNumeric),belowTiers:m,aboveTiers:b,containersIDs:A,numContsByBay:j,allContainerMeshesObj:D,filters:x,iTierMin:k,iTierMinAbove:E,iTierMax:N,iTierMaxAbove:L,tiers:g,maxWidth:M,firstBay:_.min(_.keys(w)),lastBay:I,hasZeroCell:R}}}]),e}();o.DataLoader=l},{"../utils/dom-utilities.js":7,"../utils/js-helpers.js":8,"./i18labels.js":4}],4:[function(e,t,o){"use strict";Object.defineProperty(o,"__esModule",{value:!0});var i="Loading 3D Model...";o.LOADING_DATA=i;var n="Error: Missing data source.";o.INVALID_DATA_SOURCE=n;var r="Error while parsing the JSON file.";o.ERROR_PARSING_JSON=r;var a="Click on colors to change them";o.CLICK_TO_CHANGE_COLORS=a;var s="No color settings found. Will use random.";o.NO_COLOR_SETTINGS=s;var l="Please select the document options";o.PRINTOPTS_TITLE=l;var d="Orientation";o.PRINTOPTS_ORIENTATION=d;var c="Landscape";o.PRINTOPTS_ORIENTATION_LANDSCAPE=c;var h="Portrait";o.PRINTOPTS_ORIENTATION_PORTRAIT=h;var u="Printer DPI";o.PRINTOPTS_DPI=u;var v="Paper Size";o.PRINTOPTS_SIZE=v;var p="GENERATE PDF";o.PRINTOPTS_GO=p;var f="Bays per row";o.PRINTOPTS_PERROW=f;var g="Colour by";o.PRINTOPTS_COLORBY=g;var m="Generating pages, please wait...";o.PRINTOPTS_PAGEPROGRESS=m;var b="Sending pages, please wait...";o.PRINTOPTS_SENDINGPAGES=b;var y="Download PDF";o.PRINTOPTS_DOWNLOAD=y},{}],5:[function(e,t,o){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(o,"__esModule",{value:!0});var n=function(){function e(e,t){for(var o=0;o<t.length;o++){var i=t[o];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,o,i){return o&&e(t.prototype,o),i&&e(t,i),t}}(),r=e("../utils/random-color.js"),a=function(){function e(t){i(this,e),this.models={},this.isoModels={},this.appScene=t}return n(e,[{key:"addIsoModel",value:function t(e){var t=this,o=t.isoModels;o[e.i]||(o[e.i]={d:e.depth,h:e.h,t:e.t})}},{key:"extendSpecs",value:function o(e){var t,o,i,n,a,s,l=this,d=new r.RColor,c,h;for(i in e){a=e[i];for(n in a.obs)s=a.obs[n],c=d.get(!0),h=parseInt(c.replace(/^#/,""),16),s.color=c,s.hexColor=h,s.colorIsRandom=!0}}},{key:"createBaseMaterials",value:function a(e){var t,o,i,n,r,a,s=this,l,d,c,h=this.appScene.renderer3d;for(i in e){r=e[i];for(n in r.obs)a=r.obs[n],c=a.hexColor,d=h.addContainerMaterial(c),a.materialPos=d}}}]),e}();o.ModelsFactory=a},{"../utils/random-color.js":10}],6:[function(e,t,o){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(o,"__esModule",{value:!0});var n=function(){function e(e,t){for(var o=0;o<t.length;o++){var i=t[o];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,o,i){return o&&e(t.prototype,o),i&&e(t,i),t}}(),r=e("../utils/js-helpers.js"),a=e("../utils/dom-utilities.js"),s=e("../utils/preloader.js"),l=e("./data-loader.js"),d=e("./models-factory.js"),c=e("./i18labels.js"),h=function(){function e(t){var o=arguments.length<=1||void 0===arguments[1]?{}:arguments[1];i(this,e);var n=this,s=1;this.options=r.extend({loaderColor:"#f2f2f2",loaderColorSucess:"#79e3da",sizes:[{name:"Letter",w:8.5,h:11},{name:"Legal",w:8.5,h:14},{name:"A4",w:8.3,h:11.7},{name:"A3",w:11.7,h:16.5}],dpis:[{name:"300 dpi",res:300},{name:"150 dpi",res:150}],padding:{w:.06,h:15},aboveBelowSep:2},o),this._node=function(){var e=void 0,o=void 0,i=void 0,r=void 0,s=void 0,l=void 0,d=void 0,h=void 0,u=void 0,v=void 0,p=void 0,f=void 0,g=void 0,m=void 0,b=void 0,y=void 0,T=[],w=void 0,x=void 0,_="printopts-container-"+Math.round(1e5*Math.random());e=document.createElement("div"),e.className="printopts-container",e.id=_,o=document.createElement("div"),o.className="printopts-form",o.innerHTML="<h2>"+c.PRINTOPTS_TITLE+"</h2>",o.id=_+"-form",e.appendChild(o),i=document.createElement("div"),i.className="printopts-progress",i.id=_+"-progress",e.appendChild(i),w=document.createElement("div"),w.className="printopts-container-top",o.appendChild(w),r=document.createElement("SELECT"),r.id=_+"-dropdwn-orientation",w.appendChild(r),T=[],T.push("<option value='0'>"+c.PRINTOPTS_ORIENTATION_LANDSCAPE+"</option>"),T.push("<option value='1'>"+c.PRINTOPTS_ORIENTATION_PORTRAIT+"</option>"),r.innerHTML=T.join(""),l=document.createElement("SELECT"),l.id=_+"-dropdwn-dpi",w.appendChild(l),T=[];for(b in n.options.dpis)y=n.options.dpis[b],T.push("<option value='"+b+"'>"+y.name+"</option>");l.innerHTML=T.join(""),s=document.createElement("SELECT"),s.id=_+"-dropdwn-sizes",w.appendChild(s),T=[];for(b in n.options.sizes)y=n.options.sizes[b],T.push("<option value='"+b+"'>"+y.name+"</option>");return s.innerHTML=T.join(""),d=document.createElement("SELECT"),d.id=_+"-dropdwn-perrow",w.appendChild(d),h=document.createElement("SELECT"),h.id=_+"-dropdwn-colorby",w.appendChild(h),p=document.createElement("button"),p.innerHTML=c.PRINTOPTS_GO,p.className="save",o.appendChild(p),u=document.createElement("span"),u.innerHTML=" or ",o.appendChild(u),f=document.createElement("button"),f.innerHTML="CANCEL",o.appendChild(f),e.dropdwnOr=r,e.dropdwnSz=s,e.dropdwnDp=l,e.dropdwnRw=d,e.dropdwnClr=h,e.btnSave=p,e.btnCancel=f,e.divForm=o,e.divProgress=i,document.body.appendChild(e),t&&(a.addEventLnr(t,"click",n.toggleHandler.bind(n)),a.addEventLnr(r,"change",n.dropFilterChanged.bind(n)),a.addEventLnr(s,"change",n.dropFilterChanged.bind(n)),a.addEventLnr(l,"change",n.dropFilterChanged.bind(n)),a.addEventLnr(f,"click",n.close.bind(n)),a.addEventLnr(p,"click",n.launchPdfStart.bind(n))),e}(),this.title="",this.btnLaunch=t,this.width=0,this.height=0,this.inchFactor=0,this.lineWidth=1,this.baseUrl="",this.data=null,this.dataLoader=new l.DataLoader(null),this.modelsFactory=null,this.onToggled=null,this.onSaved=null,this.postUrl=null,this._init()}return n(e,[{key:"loadUrl",value:function t(e,o,i){return this.dataLoader.loadUrl(e,o,i)}},{key:"loadData",value:function o(e){return this.dataLoader.generateStructuredData(e)}},{key:"_init",value:function s(){var e=this,t=void 0,o=void 0,i=void 0;this.modelsFactory=new d.ModelsFactory(this)}},{key:"dropFilterChanged",value:function h(){var e=this.options.dpis[this._node.dropdwnDp.value].res,t=this.options.sizes[this._node.dropdwnSz.value],o=void 0,i=void 0,n=void 0,r=void 0,a=this._node.dropdwnRw,s=this.options.padding.w,l=void 0;for(this.width=e*t["1"===this._node.dropdwnOr.value?"w":"h"],this.height=e*t["1"!==this._node.dropdwnOr.value?"w":"h"],o=[],o.push("<option value='1'>"+c.PRINTOPTS_PERROW+": 1</option>"),i=2;9>i&&(r=Math.round(this.width/(i*(1+s))),!(.3*e>r));i+=1)o.push("<option data-w='"+r+"' value='"+i+"'>"+c.PRINTOPTS_PERROW+": "+i+"</option>");a.innerHTML=o.join(""),a.selectedIndex=Math.floor(o.length/2)}},{key:"applyColorsFilter",value:function u(e){var t=[],o=void 0,i=void 0;for(o in e)i=e[o],t.push("<option value='"+o+"'>"+c.PRINTOPTS_COLORBY+": "+i.name+"</option>");this._node.dropdwnClr.innerHTML=t.join("")}},{key:"toggleHandler",value:function v(e){this.toggle(!this.isOpened)}},{key:"close",value:function p(){this.toggle(!1)}},{key:"toggle",value:function f(){var e=arguments.length<=0||void 0===arguments[0]?!0:arguments[0];return this._node.style.display=e?"block":"none",this.isOpened=e,e?(this._node.divForm.style.display="block",this._node.divProgress.style.display="none",this.dropFilterChanged(),void(this.onToggled&&this.onToggled(!0))):void(this.onToggled&&this.onToggled(!1))}},{key:"launchPdfStart",value:function g(){var e=this._node.dropdwnRw.value,t=this.options.dpis[this._node.dropdwnDp.value].res,o=this._node.dropdwnClr.value,i=this.width,n=this.height;this.pdfStart(e,t,i,n,o)}},{key:"pdfStart",value:function m(e,t,o,i,n,s){function l(t){var o=arguments.length<=1||void 0===arguments[1]?g.inchFactor:arguments[1],i=arguments.length<=2||void 0===arguments[2]?!1:arguments[2],a=arguments.length<=3||void 0===arguments[3]?!1:arguments[3],s=document.createElement("canvas"),l=void 0,d=void 0,c=void 0;if(s.width=M*o,s.height=L*o,l=s.getContext("2d"),i?(l.fillStyle="#ffffff",l.strokeStyle="#666666"):(d=b.filters[n].obs[t[n]].color,l.fillStyle=d,l.strokeStyle=r.lightenDarkenColor(d,-30)),l.lineWidth=2*g.lineWidth*o/g.inchFactor,l.rect(0,0,M*o,L*o),l.fill(),l.stroke(),a)return l.beginPath(),l.fillStyle="#666666",l.rect(M*o/9*4,L*o/9*3,M*o/9,L*o/9*3),l.fill(),l.rect(M*o/9*3,L*o/9*4,M*o/9*3,L*o/9),l.fill(),s;if(t.s||(c="e"),t.r&&(c="r"),c){var h=ne*o/g.inchFactor;7>e&&(h+=.2*(8-e)),l.font=14*h+"px Arial",l.textAlign="center",l.fillStyle="#333333",l.fillText(c,4*o,7*o)}switch(t.w&&(l.strokeStyle="#666666",l.lineWidth=1,l.moveTo(0,L*o/2),l.lineTo(M*o/2,0),l.lineTo(M*o,L*o/2),l.lineTo(M*o/2,L*o),l.lineTo(0,L*o/2),l.stroke()),9.5===t.h&&(l.fillStyle="#333333",l.beginPath(),l.moveTo(M*o*3/4,0),l.lineTo(M*o,L*o/3),l.lineTo(M*o/2,L*o/3),l.lineTo(M*o*3/4,0),l.fill()),t.l){case 40:l.fillStyle="#333333",l.beginPath(),l.rect(0,0,M*o/2,1*o),l.fill();break;case 45:l.moveTo(0,0),l.fillStyle="#333333",l.beginPath(),l.arc(0,0,3*o,2*Math.PI,Math.PI),l.fill()}return s}function d(e){var t=arguments.length<=1||void 0===arguments[1]?g.inchFactor:arguments[1],o=arguments.length<=2||void 0===arguments[2]?!1:arguments[2];return l(e,t,o,!0)}function h(e){var t=arguments.length<=1||void 0===arguments[1]?g.inchFactor:arguments[1],o=document.createElement("canvas"),i=void 0,n=void 0,r=void 0,a=e.g,s=M*t,l=L*t,d=L*Y*t,c=M*Y*t,h=s+2*d,u=l+2*c;return o.width=h,o.height=u,i=o.getContext("2d"),i.fillStyle="#444444",a.indexOf("t")>=0&&(i.beginPath(),i.ellipse(h/2,d,s/2,d,0,Math.PI,2*Math.PI),i.fill()),a.indexOf("l")>=0&&(i.beginPath(),i.ellipse(c,u/2,c,l/2,0,.5*Math.PI,1.5*Math.PI),i.fill()),a.indexOf("r")>=0&&(i.beginPath(),i.ellipse(c+s,u/2,c,l/2,0,1.5*Math.PI,.5*Math.PI),i.fill()),a.indexOf("f")>=0&&(i.beginPath(),i.moveTo(c,d+l/4),i.lineTo(c+s,d+l/4),i.stroke()),a.indexOf("b")>=0&&(i.beginPath(),i.moveTo(c,l+d-l/4),i.lineTo(c+s,l+d-l/4),i.stroke()),a.indexOf("x")>=0&&(i.beginPath(),i.moveTo(c,d),i.lineTo(h-c,u-d),i.moveTo(h-c,d),i.lineTo(c,u-d),i.stroke()),o}function u(t){var o=void 0,i=void 0,n=void 0,a=void 0,s=y[t],c=void 0,u=void 0,v=void 0,p=void 0,f=void 0,m=t,b=void 0,T=Math.round(M/2)*g.inchFactor,w=L*g.inchFactor,S=M*g.inchFactor;u=document.createElement("canvas"),u.width=k+2*K*g.inchFactor,u.height=x*g.inchFactor+2*q*g.inchFactor,v=u.getContext("2d"),s.isBlockStart&&s.maxD>20&&(m+=" ("+r.pad(Number(t)+1,3)+")"),s.isBlockStart||(c=y[r.pad(Number(t)-2,3)],c.maxD>20&&(m+=" ("+r.pad(Number(t)-1,3)+")")),b=ne,7>e&&(b+=.2*(8-e)),v.font=24*b+"px Georgia",v.textAlign="center",v.textBaseline="middle",v.fillText(m,k/2,Math.max(q/2*g.inchFactor,0)),v.font=10*b+"px Arial",v.textAlign="center",v.textBaseline="baseline",v.fillStyle="#666666",v.strokeStyle="#dddddd",v.lineWidth=2*g.lineWidth,v.save(),console.log("Step 1, Bay "+t);for(o in D)p=(D[o]-L+q)*g.inchFactor,v.fillText(r.pad(o,2),K/2*g.inchFactor,(w+6)/2+p),v.fillText(r.pad(o,2),(_.max(A)+M+1.5*K)*g.inchFactor,(w+6)/2+p);for(n in A){f=(A[Number(n)]+K)*g.inchFactor,v.fillText(r.pad(n,2),T+f,(_.min(D)-1.5*q)*g.inchFactor),v.fillText(r.pad(n,2),T+f,(_.max(D)+1.5*q)*g.inchFactor);for(o in D)p=(D[o]-L+q)*g.inchFactor,v.rect(f,p,S,w),v.stroke()}for(n in s.cells){a=s.cells[n];for(o in a.tiers){f=(A[Number(n)]+K)*g.inchFactor,p=(D[Number(o)]-L+q)*g.inchFactor;var P=l(a.tiers[o]);v.drawImage(P,f,p)}}for(n in s.cells){a=s.cells[n];for(o in a.tiers)if(a.tiers[o].g){f=(A[Number(n)]+K)*g.inchFactor,p=(D[Number(o)]-L+q)*g.inchFactor;var P=h(a.tiers[o]);v.drawImage(P,f-Q,p-Z)}}if(!s.isBlockStart&&(s=y[r.pad(Number(t)-2,3)]))for(n in s.cells){a=s.cells[n];for(o in a.tiers)if(!(1&a.tiers[o].iBay)){f=(A[Number(n)]+K)*g.inchFactor,p=(D[Number(o)]-L+q)*g.inchFactor;var P=d(a.tiers[o]);v.drawImage(P,f,p)}}return u}function v(){function t(){O>0&&O%2===0&&(r=document.createElement("canvas"),r.width=1.5*(k+2*K*g.inchFactor),r.height=x*g.inchFactor+2*q*g.inchFactor,a=r.getContext("2d"),a.font=19*m+"px Arial",a.textAlign="left",a.fillStyle="#444444",s=c,d=u,P.push(r))}function o(e,o){o[n]="",a.drawImage(l(o,g.inchFactor*y,!0),s,d),o.g&&a.drawImage(h(o,g.inchFactor*y,!0),s-w,d-T),a.fillText(e,s+14*g.inchFactor,d+8*g.inchFactor),f=Math.round(Math.max(f,a.measureText(e).width)),d+=v,d+v>r.height&&(d=u,s+=c+p+f,f=0,O+=1,t())}var i=void 0,r=void 0,a=void 0,s=0,d=0,c=Math.round(6*g.inchFactor),u=Math.round(q*g.inchFactor*2),v=Math.round(14*g.inchFactor),p=Math.round(18*g.inchFactor),f=0,m=void 0,y=1.25,T=Math.round(L*Y*g.inchFactor*y),w=Math.round(M*Y*g.inchFactor*y),_=void 0,S=void 0,P=[],O=0;r=document.createElement("canvas"),r.width=1.5*(k+2*K*g.inchFactor),r.height=x*g.inchFactor+2*q*g.inchFactor,a=r.getContext("2d"),P.push(r),m=ne,7>e&&(m+=.2*(8-e)),4>e&&(y=1.2),a.font=19*m+"px Arial",a.textAlign="left",a.fillStyle="#444444",d=u,s=c;for(i in b.filters[n].obs)_=b.filters[n].obs[i],S={s:1},S[n]=i,a.drawImage(l(S,g.inchFactor*y),s,d),a.fillText(i,s+16*g.inchFactor,d+8*g.inchFactor),f=Math.round(Math.max(f,a.measureText(i).width)),d+=v,d+v>r.height&&(d=u,s+=c+p+f,f=0,O+=1,t());return o("Hazardous",{s:1,w:1}),o("Empty",{s:0}),o("Reefer",{s:1,r:1}),o("High-cube",{s:1,h:9.5}),o("40-footer",{s:1,l:40}),o("45-footer",{s:1,l:45}),o("Break Bulk",{s:1,g:"x"}),o("Oversize Top",{s:1,g:"t"}),o("Oversize Left",{s:1,g:"l"}),o("Oversize Right",{s:1,g:"r"}),o("Oversize Front",{s:1,g:"f"}),o("Oversize Back",{s:1,g:"b"}),P}function p(){var e=g.postUrl,t=void 0,o=void 0,i=void 0,r=void 0,s=void 0,l=void 0,d=function u(e){console.error(e),V&&(V.innerHTML="An error has ocurred.")},h=function v(e){if(e.lengthComputable){var t=Math.round(100*e.loaded/e.total);V.innerHTML=e.loaded<e.total?t+"%":"Finishing, please wait..."}};for(i="0"===g._node.dropdwnOr.value,o={title:g.title,numImages:B.length,pageSize:g.options.sizes[g._node.dropdwnSz.value].name,pageSizeW:g.options.sizes[g._node.dropdwnSz.value][i?"h":"w"],pageSizeH:g.options.sizes[g._node.dropdwnSz.value][i?"w":"h"]-1,pageOrientation:i?"L":"P",filterBy:c.PRINTOPTS_COLORBY+": "+b.filters[n].name,vesselName:g.metaData.vesselName,vesselCallSign:g.metaData.vesselCallSign,sender:g.metaData.sender,recipient:g.metaData.recipient,placeOfDeparture:g.metaData.placeOfDeparture,voyageNumber:g.metaData.voyageNumber,footerLeft:g.metaData.footerLeft,footerRight:g.metaData.footerRight},r=0,s=B.length;s>r;r+=1)o["page_"+r]=B[r].toDataURL("image/png");t=jQuery.ajax({url:e,type:"POST",data:o,timeout:72e5}),V&&t.uploadProgress(h),t.fail(d),t.done(function(e){console.log(e),e.download?(V.innerHTML="<a href='"+g.baseUrl+e.download+"' target='_blank'>Download PDF</a><br /><br />",l=document.createElement("button"),l.innerHTML="Close this window",a.addEventLnr(l,"click",g.close.bind(g)),V.appendChild(l)):V.innerHTML="An error has ocurred."})}function f(){var e=void 0,t=void 0,o=void 0,i=[],n=void 0,a=void 0,s=void 0,l=void 0;for(e=0,t=T.length;t>e;e+=1)a=T[e],i.push(a),s=Number(a),n=y[a],o=e+1,(n.isBlockStart&&t>o&&Number(T[o])!==s+2||o===t)&&(l=r.pad(s+2,3),i.push(l),y[l]={n:0,maxD:n.maxD,isBlockStart:!1,cells:{},maxCell:n.maxCell});T=i}var g=this,m=this.options.aboveBelowSep,b=this.data,y=_.clone(b.dataStructured),T=_.clone(b.dataStructuredKeysArr),w=b.hasZeroCell,x=void 0,S=void 0,P=void 0,O=void 0,C=[0],k=void 0,E=void 0,N=void 0,L=8,M=8,I=void 0,R=g.options.padding.w,F=void 0,j=void 0,A={},D={},H=0,B=[],z=void 0,G=void 0,W=void 0,U=void 0,J=this._node.divForm,V=this._node.divProgress,q=5,K=5,Y=.25,Z=void 0,Q=void 0,X=void 0,ee=void 0,te=void 0,oe=void 0,ie=void 0,ne=1;for(f(),J&&(J.style.display="none"),V&&(V.style.display="block",V.innerHTML=c.PRINTOPTS_PAGEPROGRESS),x=(b.belowTiers.n+b.aboveTiers.n)*L+2*m+2*q,S=b.maxWidth*M+2*K,k=Math.floor(o/(e*(1+R))),I=Math.floor(k*R),this.lineWidth=Math.round(t/300),this.inchFactor=k/S,ne=t/300,Z=L*Y*g.inchFactor,Q=M*Y*g.inchFactor,P=1;e>P;P+=1)C[P]=C[P-1]+k+I;E=(x+L)*this.inchFactor,N=E+g.options.padding.h*this.inchFactor,X=k*e+I*(e-1),te=Math.min(Math.floor(i/N),Math.ceil(T.length/e)),ee=te*E+(te-1)*g.options.padding.h*this.inchFactor,oe=Math.round((i-ee)/2),ie=Math.round((o-X)/2),F=Number(_.max(y,function(e){return e.maxCell}).maxCell),j=(F+(w?1:0))*M;var re=0,ae=j-M;for(P=F,O=w?0:1;P>=O;P-=1)P%2===0?(A[P]=re,re+=M):(A[P]=ae,ae-=M);for(H=0,P=b.iTierMin,O=b.iTierMax;O>=P;P+=2)D[P]=x-H,H+=L;for(H+=2*m,P=b.iTierMinAbove,O=b.iTierMaxAbove;O>=P;P+=2)D[P]=x-H,H+=L;z=document.createElement("canvas"),z.width=o,z.height=i,G=z.getContext("2d"),U=0,setTimeout(function(){for(var t=0,n=T.length;n>t;t+=1){var r=T[t];if(r){var a=u(T[t]);if(G.drawImage(a,C[t%e]+ie,U+oe),((t+1)%e===0||t+1===n)&&(U+=N,U+N>i||t+1===n))if(B.push(z),n>t+1)z=document.createElement("canvas"),z.width=o,z.height=i,G=z.getContext("2d"),U=0;else{(t+1)%e!==0&&(U-=N);for(var s=v(),l=void 0,d=0,h=s.length;h>d;d+=1)l=t+d+1,U+N>i&&(z=document.createElement("canvas"),z.width=o,z.height=i,G=z.getContext("2d"),U=0,B.push(z)),G.drawImage(s[d],Math.round(C[l%e]+ie),Math.round(U+oe)),l%e===e&&(U+=N)}}}V.innerHTML=c.PRINTOPTS_SENDINGPAGES,p()},50),window.pagess=B}},{key:"setTitle",value:function b(e,t,o){var i=(e?e:"")+(t?" / "+t:"")+(o?" / "+o:"");i&&(this.title=i)}},{key:"setMetaData",value:function y(e,t,o,i,n,r,a,s){this.metaData={vesselName:e,vesselCallSign:t,sender:o,recipient:i,placeOfDeparture:n,voyageNumber:r,footerLeft:a,footerRight:s}}}]),e}();o.VesselsApp2D=h},{"../utils/dom-utilities.js":7,"../utils/js-helpers.js":8,"../utils/preloader.js":9,"./data-loader.js":3,"./i18labels.js":4,"./models-factory.js":5}],7:[function(e,t,o){"use strict";Object.defineProperty(o,"__esModule",{value:!0});var i=function s(e){return e&&e.tagName&&("textarea"===e.tagName.toLowerCase()||"input"===e.tagName.toLowerCase()&&"text"===e.type.toLowerCase())};o.isInputOrTextarea=i;var n=function l(e){return"object"==typeof HTMLElement?id instanceof HTMLElement:"object"==typeof id&&1===id.nodeType&&"string"==typeof id.nodeName};o.isHtmlNode=n;var r=function d(e,t,o){window.attachEvent?(e["e"+t+o]=o,e[t+o]=function(){e["e"+t+o](window.event)},e.attachEvent("on"+t,e[t+o])):e.addEventListener(t,o,!1)};o.addEventLnr=r;var a=function c(e){if(window.Event&&"function"==typeof window.Event)return new Event(e);var t=document.createEvent("Event");return t.initEvent(e,!0,!0),t};o.addEventDsptchr=a},{}],8:[function(e,t,o){"use strict";function i(e,t,o){e?t.apply(null,arguments):o.apply(null,arguments)}function n(e,t){var o=!1;"#"==e[0]&&(e=e.slice(1),o=!0);var i=parseInt(e,16),n=(i>>16)+t;n>255?n=255:0>n&&(n=0);var r=(i>>8&255)+t;r>255?r=255:0>r&&(r=0);var a=(255&i)+t;return a>255?a=255:0>a&&(a=0),(o?"#":"")+(a|r<<8|n<<16).toString(16)}Object.defineProperty(o,"__esModule",{value:!0}),o.callOnCondition=i,o.lightenDarkenColor=n;var r=function p(e){return Array.isArray?Array.isArray(e):e instanceof Array};o.isArray=r;var a=function f(e,t){var o=void 0,i=JSON.parse(JSON.stringify(e));if(t)for(o in t)Object.prototype.hasOwnProperty.call(t,o)&&Object.prototype.hasOwnProperty.call(i,o)&&(i[o]=t[o]);return i};o.extend=a;var s=function g(e,t){return e-t};o.sortNumeric=s;var l=function m(e){var t=arguments.length<=1||void 0===arguments[1]?!0:arguments[1],o=arguments.length<=2||void 0===arguments[2]?!0:arguments[2],i=e;return t&&(i=i.replace(/^\s\s*/,"")),o&&(i=i.replace(/\s\s*$/,"")),i};o.trimString=l;var d=function b(e){var t=void 0,o=void 0,i=new Set;for(t=0,o=e.length;o>t;t+=1){var n=l(e[t]);i.has(n)||i.add(n)}return ouputSet};o.arrayToSet=d;var c=function y(e,t){var o=void 0,i=[];for(o in e)i.push(o);return t&&(i=i.sort(s)),i};o.objKeysToArray=c;var h=function T(e){var t=Number(e).toString(16);return t="000000".substr(0,6-t.length)+t,t.toUpperCase()};o.decimalToHex=h;var u=function w(e,t){var o="000"+String(e);return o.substr(o.length-t)};o.pad=u;var v=function x(){for(var e=document.location.search.split("+").join(" "),t={},o=void 0,i=/[?&]?([^=]+)=([^&]*)/g;o=i.exec(e);)t[decodeURIComponent(o[1])]=decodeURIComponent(o[2]);return t};o.getQueryParams=v},{}],9:[function(e,t,o){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(o,"__esModule",{value:!0});var n=function(){function e(e,t){for(var o=0;o<t.length;o++){var i=t[o];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,o,i){return o&&e(t.prototype,o),i&&e(t,i),t}}(),r=function(){function e(t,o,n,r,a,s){void 0===t&&(t=mandatory()),i(this,e);var l=void 0;null!==t&&void 0!==t&&(this.node=t,l=document.createElement("canvas"),this.messages=o,this.canv=l,this.ctx=l.getContext("2d"),this.loadCurrent=0,this.radius=n,this.canv.width=Math.round(2*n),this.canv.height=Math.round(2*n),this.setPixelRatio(),this.opts=r,this.node.appendChild(l),this.image=a?document.getElementById(a):null,s&&this.setMessage(s))}return n(e,[{key:"rectLoader",value:function t(){
var e=this.loadCurrent,t=this.ctx,o=this.radius,i=2*o,n=Math.round(o/2),r=2*e*Math.PI,a=this.opts;t.clearRect(0,0,i,i),t.beginPath(),t.arc(o,o,n,0,2*Math.PI,!1),t.fillStyle=a.loaderColor,t.fill(),t.lineWidth=1,t.strokeStyle=a.loaderColor,t.stroke(),t.beginPath(),t.arc(o,o,Math.round(n/2),0,r,!1),t.lineWidth=n,t.strokeStyle=a.loaderColorSucess,t.stroke(),this.image&&t.drawImage(this.image,n,n,o,o)}},{key:"setPixelRatio",value:function o(){var e=void 0,t=void 0,o=this.ctx,i=window.devicePixelRatio||1,n=o.webkitBackingStorePixelRatio||o.mozBackingStorePixelRatio||o.msBackingStorePixelRatio||o.oBackingStorePixelRatio||o.backingStorePixelRatio||1,r=i/n;i!==n&&(e=this.canv.width,t=this.canv.height,this.canv.width=e*r,this.canv.height=t*r,this.canv.style.width=e+"px",this.canv.style.height=t+"px",this.ctx.scale(r,r))}},{key:"setMessage",value:function r(e){var t=arguments.length<=1||void 0===arguments[1]?!1:arguments[1];this.messages&&(this.messages.innerHTML=e,this.messages.style.color=t?"red":"")}},{key:"updateLoader",value:function a(e,t){var o=this;o.node&&TweenLite.to(o,t,{loadCurrent:e,ease:Power1.easeInOut,onUpdate:o.rectLoader,onUpdateScope:o})}},{key:"startAnimation",value:function s(){this.node&&(this.rectLoader(),this.updateLoader(.4,2))}},{key:"stopAnimation",value:function l(){this.node&&this.updateLoader(1,.25)}},{key:"setPercentage",value:function d(e){this.node&&(this.loadCurrent=e,this.rectLoader())}},{key:"show",value:function c(){this.node&&(this.node.style.display="block")}},{key:"hide",value:function h(){this.node&&(this.node.style.display="none")}}],[{key:"mandatory",value:function u(){throw new Error("Missing parameter")}}]),e}();o["default"]=r,t.exports=o["default"]},{}],10:[function(e,t,o){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(o,"__esModule",{value:!0});var n=function(){function e(e,t){for(var o=0;o<t.length;o++){var i=t[o];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,o,i){return o&&e(t.prototype,o),i&&e(t,i),t}}(),r=function(){function e(){i(this,e),this.hue=Math.random(),this.goldenRatio=.618033988749895,this.hexwidth=2}return n(e,[{key:"hsvToRgb",value:function t(e,o,i){var n=Math.floor(6*e),r=6*e-n,a=i*(1-o),s=i*(1-r*o),l=i*(1-(1-r)*o),d=255,c=255,h=255;switch(n){case 0:d=i,c=l,h=a;break;case 1:d=s,c=i,h=a;break;case 2:d=a,c=i,h=l;break;case 3:d=a,c=s,h=i;break;case 4:d=l,c=a,h=i;break;case 5:d=i,c=a,h=s}return[Math.floor(256*d),Math.floor(256*c),Math.floor(256*h)]}},{key:"padHex",value:function o(e){return e.length>this.hexwidth?e:new Array(this.hexwidth-e.length+1).join("0")+e}},{key:"get",value:function r(e,t,o){this.hue+=this.goldenRatio,this.hue%=1,"number"!=typeof t&&(t=.5),"number"!=typeof o&&(o=.95);var i=this.hsvToRgb(this.hue,t,o);return e?"#"+this.padHex(i[0].toString(16))+this.padHex(i[1].toString(16))+this.padHex(i[2].toString(16)):i}}]),e}();o.RColor=r},{}]},{},[1]);