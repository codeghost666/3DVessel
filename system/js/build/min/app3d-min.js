!function e(t,i,o){function n(r,s){if(!i[r]){if(!t[r]){var l="function"==typeof require&&require;if(!s&&l)return l(r,!0);if(a)return a(r,!0);var d=new Error("Cannot find module '"+r+"'");throw d.code="MODULE_NOT_FOUND",d}var c=i[r]={exports:{}};t[r][0].call(c.exports,function(e){var i=t[r][1][e];return n(i?i:e)},c,c.exports,e,t,i,o)}return i[r].exports}for(var a="function"==typeof require&&require,r=0;r<o.length;r++)n(o[r]);return n}({1:[function(e,t,i){"use strict";var o=e("../core/vessels-3d.js"),n=e("../core/vessels-2d.js"),a=e("../utils/js-helpers.js"),r=e("../utils/dom-utilities.js"),s=e("../colors/colors-widget.js"),l=e("../core/i18labels.js"),d=document.getElementById("app-3d"),c=document.getElementById("titleH1"),u=document.getElementById("titleBay"),h=document.getElementById("info-window"),p=document.getElementById("dropColors"),v=document.getElementById("launchColorsWidget"),m=document.getElementById("btnLaunchPDF"),f=a.getQueryParams(),y,g,b;b={dropFilter:null,dropFilterValue:null,showWireframes:null,currentlyHidden:[],latestFilter:"",dropBays:null,dropBaysDictionary:{},dropAddHouse:null,openBayInfo:null,closeBayInfo:null,bayInfo:null,bayInfoIframe:null,baySelected:"",shipHouseSpace:20.5,isExpanded:!1,prevnextCont:null,prevnextNum:1,numContsByBlock:null,hatchDecksVisible:!0,init:function E(){var e=p,t=document.getElementById("dropFilter"),i=void 0,o=void 0,n=b,s=void 0,l=void 0,d=y.data.filters;n.dropFilterValue=document.getElementById("dropFilterValue"),n.showWireframes=document.getElementById("showWireframesFiltered"),n.expandViewBtn=document.getElementById("expandView"),n.prevnextCont=document.getElementById("prevnext-container"),n.dropFilter=t,n.checkboxHatchCovers=document.getElementById("view-hcs"),n.navBaysNext=document.getElementById("bay-next"),n.navBaysPrev=document.getElementById("bay-prev"),o=document.createElement("option"),o.value="",o.innerHTML="None",t.appendChild(o);var c=[];for(i in d)c.push({name:d[i].name,key:i});for(c=c.sort(function(e,t){return e.name>=t.name?1:-1}),s=0,l=c.length;l>s;s+=1)i=c[s].key,o=document.createElement("option"),o.value=i,o.innerHTML=d[i].name,t.appendChild(o),o=document.createElement("option"),o.value=i,o.innerHTML=d[i].name,e.appendChild(o);e.value="i",r.addEventLnr(t,"change",n.prepareFilter),r.addEventLnr(n.dropFilterValue,"change",n.processFilterValue),r.addEventLnr(e,"change",n.colorize),r.addEventLnr(n.showWireframes,"change",n.listenWireframeDisplay),r.addEventLnr(window,"keydown",n.checkKeyPressed),r.addEventLnr(n.expandViewBtn,"change",n.expandView),r.addEventLnr(n.checkboxHatchCovers,"change",n.toggleHatchCovers),r.addEventLnr(n.navBaysNext,"click",function(){a.callOnCondition(n.isExpanded,n.expandViewNext,n.baysControlNext)}),r.addEventLnr(n.navBaysPrev,"click",function(){a.callOnCondition(n.isExpanded,n.expandViewPrev,n.baysControlPrev)}),n.addBaysControl(),n.addHouseControl(),n.pauseControls(!1)},addBaysControl:function w(){function e(e){var t=e.target.value;p.isolateBay(t)}var t,i,o,n,s=document.getElementById("dropBays"),l=[],d,c,u,h,p=b,v,m=y.renderer3d.g3Bays,f=y.data.dataStructured,g=["<option value=''>All bays</option>"];for(t in m)n=m[t],n.children.length>0&&l.push(n.name.replace("b",""));for(l=l.sort(a.sortNumeric),i=0,o=l.length;o>i;i+=1)v=Number(l[i]),d=v%2===1,d?f[l[i]].n&&(g.push("<option value='"+l[i]+"'>"+l[i]+"</option>"),p.dropBaysDictionary[l[i]]=l[i]):(c=o>i+1&&Number(l[i+1])===v+1,c||p.dropBaysDictionary[a.pad(v-1,3)]||(g.push("<option value='"+a.pad(v,3)+"'>"+a.pad(v-1,3)+"</option>"),p.dropBaysDictionary[a.pad(v-1,3)]=a.pad(v,3)));s.innerHTML=g.join(""),p.dropBays=s,r.addEventLnr(p.dropBays,"change",e),p.openBayInfo=document.getElementById("open-panel"),p.closeBayInfo=document.getElementById("close-panel"),p.bayInfo=document.getElementById("bay-panel"),p.bayInfoIframe=document.getElementById("bay-iframe-container"),r.addEventLnr(p.openBayInfo,"click",p.showBayInfo),r.addEventLnr(p.closeBayInfo,"click",p.showBayInfo),p.openBayInfo.style.left="-300px"},baysControlNext:function x(){var e=b,t=e.dropBays.selectedIndex+1,i=e.dropBays.length;i>t&&(e.dropBays.selectedIndex=t,e.isolateBay(e.dropBays.value)),e.navBaysPrev.className="prevnext bay-prev noselect "+(t>2?"active":""),e.navBaysNext.className="prevnext bay-next noselect "+(t+1>=i?"":"active")},baysControlPrev:function T(){var e=b,t=e.dropBays.selectedIndex-1,i=e.dropBays.length;t>=0&&(e.dropBays.selectedIndex=t,e.isolateBay(e.dropBays.value)),e.navBaysPrev.className="prevnext bay-prev noselect "+(t>2?"active":""),e.navBaysNext.className="prevnext bay-next noselect "+(t+1>=i?"":"active")},addHouseControl:function C(){var e=b,t=document.getElementById("dropAddHouse"),i=y.data.dataStructured,o,n,s,l,d=["<option value=''>No house</option>"];for(n=a.objKeysToArray(e.dropBaysDictionary),n=n.sort(a.sortNumeric),s=n.length-1;s>=0;s-=1)o=n[s],i[o].maxD>20&&d.push("<option value='"+e.dropBaysDictionary[o]+"'>before "+o+"</option>");t.innerHTML=d.join(""),r.addEventLnr(t,"change",e.moveShipHouseLnr),e.dropAddHouse=t},_makeHeightVisible:function S(e){var t=Number(e),i=Math.floor(t),o=1.2*(t-i);return i+o},prepareFilter:function R(e){var t=e.target.value,i,o,n=["<option value=''>No filter</option>"],a=b,r=y.data.filters;if(!t)return a.pauseControls(!0),a.showHiddenMeshes(),a.pauseControls(!1),a.dropFilterValue.value="",a.dropFilterValue.innerHTML=n.join(""),void a.dropFilterValue.setAttribute("disabled","disabled");if(a.latestFilter!==t&&(a.pauseControls(!0),a.showHiddenMeshes(),a.pauseControls(!1)),a.latestFilter=t,a.dropFilterValue.removeAttribute("disabled"),a.dropFilterValue.innerHTML="",o=r[t],o.tf)n.push("<option value='1'>yes</option>"),n.push("<option value='0'>no</option>");else{var s=_.keys(o.obs).sort(),l=void 0,d=void 0;for(l=0,d=s.length;d>l;l+=1)n.push("<option value='"+s[l]+"'>"+("h"===t?a._makeHeightVisible(s[l]):s[l])+"</option>")}a.dropFilterValue.innerHTML=n.join("")},processFilterValue:function P(e){var t=e.target.value,i=b,o=i.dropFilter,n,a,r,s=i.showWireframes.checked,l=y.data.filters,d=y.data.allContainerMeshesObj,c=[],u,h;if(i.pauseControls(!0),i.showHiddenMeshes(),""===t)return void i.pauseControls(!1);u=l[i.dropFilter.value].obs;for(r in u)if(i.dropFilterValue.value!==r)for(n=0,a=u[r].indexes.length;a>n;n+=1)h=d[u[r].indexes[n].c],s?(h.isBasic=!0,h.material=y.renderer3d.basicMaterial):h.visible=!1,c.push(u[r].indexes[n].c);i.currentlyHidden=c,i.pauseControls(!1)},processWireframeDisplay:function M(e){var t=b,i=t.currentlyHidden,o,n,a=y.data.allContainerMeshesObj,r=i.length;if(r)for(o=0;r>o;o+=1)n=a[i[o]],e?(n.isBasic=!0,n.material=y.renderer3d.basicMaterial,n.visible=!0):n.visible=!1},listenWireframeDisplay:function k(e){var t=e.target.checked,i=b;i.pauseControls(!0),i.processWireframeDisplay(t),i.pauseControls(!1)},showHiddenMeshes:function H(){var e=b.currentlyHidden,t,i,o=e.length,n=y.data.allContainerMeshesObj;if(o>0)for(t=0;o>t;t+=1)i=n[e[t]],i.isBasic&&(i.material=y.renderer3d.allMaterials[i.materialPos],i.isBasic=!1),i.visible=!0;b.currentlyHidden=[]},pauseControls:function N(e){var t=b,i;return e?(i=t.dropFilterValue.getAttribute("disabled"),t.dropFilter.setAttribute("disabled","disabled"),t.dropFilterValue.setAttribute("disabled","disabled"),t.dropFilterValue.setAttribute("prevAttr",i),t.showWireframes.setAttribute("disabled","disabled"),t.dropBays.setAttribute("disabled","disabled"),void t.dropAddHouse.setAttribute("disabled","disabled")):(i=t.dropFilterValue.getAttribute("prevAttr"),t.dropFilter.removeAttribute("disabled"),"disabled"!==i&&t.dropFilterValue.removeAttribute("disabled"),t.showWireframes.removeAttribute("disabled"),void(t.isExpanded||(t.dropBays.removeAttribute("disabled"),t.baySelected||t.dropAddHouse.removeAttribute("disabled"))))},colorize:function B(e){var t=e.target.value,i,o,n,a,r=y.data.allContainerMeshesObj,s=y.data.filters,l=y.data.data;for(b.showColorsTable(t),i=0,o=l.info.contsL;o>i;i+=1)a=l.conts[i],n=r[a.cDash],n.materialPos=s[t].obs[a[t]].materialPos,n.isBasic||(n.material=y.renderer3d.allMaterials[n.materialPos])},isolateBay:function L(e){function t(e,t,i,o,n){var r,s,l,d,c,u,v;c=e-1,h["b"+a.pad(c,3)]||(c+=2);for(r in h)v=h[r],s=Number(v.name.replace("b","")),s!==e&&s!==c&&(e>s?TweenLite.to(v.position,t,{z:v.originalZ-i,delay:o,ease:Power2.easeInOut}):TweenLite.to(v.position,t,{z:v.originalZ+i,delay:o,ease:Power2.easeInOut}));return y.renderer3d.shipHouse.mesh.visible&&(u=e<p.currPosBay?i:-i,TweenLite.to(p.mesh.position,t,{z:p.currPosZ+u,delay:o,ease:Power2.easeInOut})),l=h["b"+a.pad(e,3)],d=h["b"+a.pad(c,3)],l&&TweenLite.to(l.position,t,{y:n,delay:.5,ease:Power2.easeInOut}),d&&TweenLite.to(d.position,t,{y:n,delay:.5,ease:Power2.easeInOut}),l.originalZ}function i(e){var i,o,n,a,c,u,h,p,v,m,f,g=b,E,w,x,T=y.options,C=y.renderer3d.controls,S=y.renderer3d.camera.position;if(g.pauseControls(!0),g.expandViewBtn.setAttribute("disabled","disabled"),x=""!==g.baySelected,x?(t(Number(g.baySelected),.35,0,0,0),r>0&&(d=t(r,.4,s,.75,l))):d=t(r,1,s,0,l),""!==e){g.baySelected=e,a=d-240,c=l,u=0,h=l-10,f=.5,C.dampingFactor=T.dampingFactorIn,E=30,d+=11,g.checkboxHatchCovers.setAttribute("disabled","disabled"),g.expandViewBtn.setAttribute("disabled","disabled"),y._bayNode.innerHTML="<small>bay</small> "+r,g.prevnextCont.style.display="block";var R=g.dropBays.selectedIndex,P=g.dropBays.length;g.navBaysPrev.className="prevnext bay-prev noselect "+(R>1?"active":""),g.navBaysNext.className="prevnext bay-next noselect "+(R+1===P?"":"active")}else g.baySelected="",a=g.initialCameraPosition.z,c=g.initialCameraPosition.y,u=g.initialCameraPosition.x,h=0,d=g.initialCameraPosition.targetZ,f=0,C.dampingFactor=T.dampingFactorOut,E=-300,g.checkboxHatchCovers.removeAttribute("disabled"),g.prevnextCont.style.display="none";TweenLite.to(S,1,{x:u,y:c,z:a,delay:f,ease:Power2.easeInOut}),TweenLite.to(C.target,2,{y:h,x:0,z:d,ease:Power2.easeInOut}),TweenLite.to(g.openBayInfo,1,{left:E,delay:4*f,ease:Power2.easeInOut}),setTimeout(function(){""===g.baySelected&&g.expandViewBtn.removeAttribute("disabled"),g.pauseControls(!1)},2500)}var o=arguments.length<=1||void 0===arguments[1]?!1:arguments[1],n=b,r=Number(e),s=40,l=500,d,c=y.data.dataStructured,u=y.data.filters,h=y.renderer3d.g3Bays,p=y.renderer3d.shipHouse;i(e?e:""),e?n.dropAddHouse.setAttribute("disabled","disabled"):n.dropAddHouse.removeAttribute("disabled")},showBayInfo:function I(e){var t="open-panel"===e.target.id,i=b,o,n;t?(i.bayInfo.style.display="block",y.pauseRendering(),o=Math.floor(.85*y.height),i.bayInfoIframe.src=window.bayviewRoute+"?filetoload="+f.filetoload+"&from3d=true&bay="+Number(i.baySelected),i.bayInfoIframe.style.height=o+"px"):(i.bayInfo.style.display="none",y.resumeRendering(),i.bayInfoIframe.src="")},tryToLaunchBay:function D(e){var t=b,i=y.data.dataStructured,o,n;if(e&&"n"!==e){if(i[e])return t.dropBays.value=t.dropBaysDictionary[e],void t.isolateBay(e);o=Number(e),n=a.pad(o+1,3),i[n]&&(t.dropBays.value=n,t.isolateBay(n))}},moveShipHouseLnr:function O(e){var t=e.target.value;b.moveShipHouse(t)},moveShipHouse:function j(e){var t,i,o,n=b,a,r,s,l=y.renderer3d.shipHouse,d=y.renderer3d.g3Bays,c=y.renderer3d.hatchCovers,u=n.shipHouseSpace;if(y.pauseRendering(),l.currPosBay>0)for(t in d)i=d[t],o=Number(i.name.replace("b","")),o<l.currPosBay&&(i.position.z+=u,i.originalZ+=u,c[t]&&(c[t].position.z+=u,c[t].originalZ+=u));if(""===e)return l.mesh.visible=!1,void y.resumeRendering();l.currPosBay=Number(e);for(t in d)i=d[t],o=Number(i.name.replace("b","")),o<l.currPosBay&&(i.position.z-=u,i.originalZ-=u,c[t]&&(c[t].position.z-=u,c[t].originalZ-=u));l.mesh.visible=!0,l.mesh.position.z=d["b"+e].position.z-u-.5,l.currPosZ=Number(l.mesh.position.z),y.resumeRendering()},checkKeyPressed:function A(e){var t=b;switch(e.keyCode){case 27:if(t.isExpanded)return;""!==t.baySelected?(t.dropBays.value="",t.bayInfo.style.display="none",y.renderer3d._isRendering=!0,t.isolateBay("")):TweenLite.to(y.renderer3d.camera.position,1,{y:t.initialCameraPosition.y,x:t.initialCameraPosition.x,z:t.initialCameraPosition.z,ease:Power2.easeInOut})}},showColorsTable:function F(e){var t=b,i=document.getElementById("tableColors"),o=[],n,e,a,r,s=y.data.filters,l=s[e],d,c,u;for(a=l.tf,d=a?["1","0"]:_.keys(l.obs).sort(),c=0,u=d.length;u>c;c+=1)n=d[c],r=l.obs[n],a?r&&o.push("<li><span style='background:"+r.color+"'></span>"+("1"===n?"yes":"no")+"</li>"):o.push("<li><span style='background:"+r.color+"'></span>"+("h"===e?t._makeHeightVisible(n):n)+"</li>");i.innerHTML=o.join("")},expandView:function V(e){function t(){if(!n.numContsByBlock){var e={},t=void 0,i=void 0,o=y.data.numContsByBay;for(t=1;E+1>=t;t+=1)i=a.pad(t,3),l=u["b"+i],l&&(e[l.compactBlockNum]||(e[l.compactBlockNum]={n:0}),e[l.compactBlockNum].n+=o[i]||0);n.numContsByBlock=e}}function i(){var e=void 0,t=0;for(n.dropBays.setAttribute("disabled","disabled"),n.dropAddHouse.setAttribute("disabled","disabled"),c=1;E+1>=c;c+=1)d=a.pad(c,3),l=u["b"+d],l&&(e=n.numContsByBlock[l.compactBlockNum],l.isBlockStart&&e.n&&(f-=m,l.labels.visible=!0,t||(t=l.iBay)),l.position.z=1&c&&!l.isBlockStart?22.5+v:0,l.position.x=f,l.position.y=0);n.prevnextNum=1,n.navBaysPrev.className="prevnext bay-prev noselect ",y._bayNode.innerHTML="<small>bay</small> 1",y.renderer3d.simpleDeck.visible=!1,y.renderer3d.hatchDeck.visible=!1,y.renderer3d.shipHouse.prevVisible=y.renderer3d.shipHouse.mesh.visible,y.renderer3d.shipHouse.mesh.visible=!1,y.renderer3d.camera.position.set(0,-2,.8*-m),y.renderer3d.controls.target.set(0,0,20),n.prevnextCont.style.display="block",n._showBaysHatchCovers(n.hatchDecksVisible),n.openBayInfo.style.left="30px",n.baySelected=a.pad(t,3)}function o(){for(d in u)l=u[d],l.position.z=l.originalZ,l.position.x=0,l.position.y=0,l.labels&&(l.labels.visible=!1);var e=b.initialCameraPosition;y.renderer3d.setCameraPosition(e.x,e.y,e.z),y.renderer3d.controls.target.x=0,y.renderer3d.controls.target.y=0,y.renderer3d.controls.target.z=e.targetZ,y.renderer3d.simpleDeck.visible=!0,y.renderer3d.hatchDeck.visible=n.hatchDecksVisible,y.renderer3d.shipHouse.mesh.visible=y.renderer3d.shipHouse.prevVisible,n.prevnextCont.style.display="none",n.pauseControls(!1),n.openBayInfo.style.left="-300px",n.baySelected=""}var n=b,r=e.target.checked,s=void 0,l=void 0,d=void 0,c=void 0,u=y.renderer3d.g3Bays,h=y.data.dataStructured,p=y.renderer3d.maxWidth,v=y.options.extraSep,m=p*(9.5+v)*1.5,f=m,g=!0,E=y.data.lastBay;t(),n.isExpanded=r,y.pauseRendering(),(r?i:o)(),y.resumeRendering()},expandViewNext:function z(){b.expandViewNextPrev(!0)},expandViewPrev:function W(){b.expandViewNextPrev(!1)},expandViewNextPrev:function G(e){function t(){var t=void 0,o=void 0;s=i.prevnextNum;do if(s+=e?1:-1,0>=s||s>y.renderer3d.maxCompactBlockNums)return null;while(i.numContsByBlock[s].n<=0);for(i.navBaysPrev.className="prevnext bay-prev noselect "+(s>1?"active":""),i.navBaysNext.className="prevnext bay-next noselect "+(s===y.renderer3d.maxCompactBlockNums?"":"active"),o=1;d+1>=o;o+=1)if(n=a.pad(o,3),t=l["b"+n],t&&t.compactBlockNum===s&&i.numContsByBlock[t.compactBlockNum].n)return t;return null}var i=b,o=.5,n=void 0,r=void 0,s=void 0,l=y.renderer3d.g3Bays,d=y.data.lastBay,c=function u(e,t){return e?t:!t};r=t(),r&&(TweenLite.to(y.renderer3d.camera.position,o,{x:r.position.x,ease:Power2.easeInOut}),TweenLite.to(y.renderer3d.controls.target,o,{x:r.position.x,ease:Power2.easeInOut}),y._bayNode.innerHTML="<small>bay</small> "+r.iBay,i.baySelected=a.pad(r.iBay,3),i.prevnextNum=s)},toggleHatchCovers:function U(e){var t=b,i=e.target.checked,o=y.renderer3d.hatchDeck;t.hatchDecksVisible=i,t.isExpanded?(o.visible=!1,t._showBaysHatchCovers(i)):(o.visible=i,t._showBaysHatchCovers(!1))},_showBaysHatchCovers:function Z(e){var t=void 0,i=void 0,o=y.renderer3d.g3Bays;for(t in o)i=o[t],i.isBlockStart&&i.hatchC&&(i.hatchC.visible=e)},disableRendering:function J(e){y.toggleRendering(!e),y.renderer3d.controls.enabled=!e},updateSceneAfterCustomColors:function K(e,t,i){function o(e){var t=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(e);return t?{r:parseInt(t[1],16),g:parseInt(t[2],16),b:parseInt(t[3],16)}:null}var n=void 0,a=void 0,r=void 0,s=void 0,l=void 0;y.data.filters=e;for(n in t)a=n.split("."),2===a.length&&(s=e[a[0]].obs[a[1]],l=y.renderer3d.allMaterials[s.materialPos],r=o(s.color),l.color.setRGB(r.r/255,r.g/255,r.b/255),l.needsUpdate=!0);b.showColorsTable(p.value)}},y=new o.VesselsApp3D(d,c,h,u),y.loadUrl(f.json,l.LOADING_DATA).then(function(e){var t=y.renderer3d,i=void 0,o=y.modelsFactory,a=void 0,r=void 0,l=void 0;y.updateHtmlTitle(e.VesselName,e.PlaceOfDeparture,e.VoyageNumber),a=y.loadData(e),y.data=a;for(var d=0,c=y.data.data.info.contsL;c>d;d+=1){var u=y.data.data.conts[d];t.createBay(u.bay),o.addIsoModel(u)}o.extendSpecs(y.data.filters),i=new s.ColorsWidget(v,y.data.filters,p),i.onToggled=b.disableRendering,i.onSaved=b.updateSceneAfterCustomColors,i.postUrl=window.writeColorsRoute,window.userSettings&&i.mergeColorSettings(window.userSettings),o.createBaseMaterials(y.data.filters),t.createBaseModels(o.isoModels),t.create3dContainersFromData(y.data),y.data.data.conts[0]&&t.putInfoWindow(y.data.data.conts[0]),b.init(),b.showColorsTable("i"),b.tryToLaunchBay(y.initialBay),r=t.maxDepth,l=Math.round(r/2),b.initialCameraPosition=t.setCameraPosition(-Math.round(.75*r),350,Math.round(.5*r)),t.controls.maxDistance=1.5*r,t.controls.target.z=l,b.initialCameraPosition.targetZ=l,g=new n.VesselsApp2D(m),g.data=a,g.applyColorsFilter(g.data.filters),g.setTitle(e.VesselName,e.PlaceOfDeparture,e.VoyageNumber),g.setMetaData(e.VesselName,e.VesselCallSign,e.Sender,e.Recipient,e.PlaceOfDeparture,e.VoyageNumber,e.FooterLeft,e.FooterRight),g.postUrl=window.generatePdfRoute,g.onToggled=b.disableRendering,window.appVessels2D=g},function(e){y._node.loadingDiv.setMessage(e,!0),y._node.loadingDiv.updateLoader(0,1)}),window.appVessels3D=y},{"../colors/colors-widget.js":2,"../core/i18labels.js":4,"../core/vessels-2d.js":7,"../core/vessels-3d.js":8,"../utils/dom-utilities.js":12,"../utils/js-helpers.js":13}],2:[function(e,t,i){"use strict";function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(i,"__esModule",{value:!0});var n=function(){function e(e,t){for(var i=0;i<t.length;i++){var o=t[i];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,i,o){return i&&e(t.prototype,i),o&&e(t,o),t}}(),a=e("../utils/js-helpers.js"),r=e("../utils/dom-utilities.js"),s=e("../core/i18labels.js"),l=function(){function e(t,i){var n=arguments.length<=2||void 0===arguments[2]?null:arguments[2];o(this,e);var a=this;this.isOpened=!1,this.btn=t,this.referenz=n,this.filters=i||{},this._currentOption=null,this._node=function(){var e=void 0,o=void 0,n=void 0,l=void 0,d=void 0,c=void 0,u=void 0,h=void 0,p=void 0,v=[],m=void 0,f="colors-container-"+Math.round(1e5*Math.random());e=document.createElement("div"),e.className="colors-container",e.innerHTML="<h2>"+s.CLICK_TO_CHANGE_COLORS+"</h2>",e.id=f,m=document.createElement("div"),m.className="colors-container-top",o=document.createElement("SELECT"),o.id=f+"-dropdwn",m.appendChild(o);for(h in i)p=i[h],v.push("<option value='"+h+"'>"+p.name+"</option>");return o.innerHTML=v.join(""),l=document.createElement("button"),l.innerHTML="SAVE",m.appendChild(l),d=document.createElement("button"),d.innerHTML="CANCEL",m.appendChild(d),e.appendChild(m),n=document.createElement("ul"),n.className="colors-container-ulColors",n.id=f+"-ulColors",e.appendChild(n),c=document.createElement("div"),c.className="colors-container-colorPicker",c.id=f+"-colorPicker",e.appendChild(c),e.dropdwn=o,e.ulColors=n,e.colorPickerDiv=c,e.btnSave=l,e.btnCancel=d,e.colorsTemp={},document.body.appendChild(e),t&&(r.addEventLnr(t,"click",a.toggleHandler.bind(a)),r.addEventLnr(o,"change",a.dropFilterChanged.bind(a)),r.addEventLnr(d,"click",a.close.bind(a)),r.addEventLnr(l,"click",a.saveColors.bind(a)),r.addEventLnr(n,"click",a.selectOption.bind(a))),e}(),this.onToggled=null,this.onSaved=null,this.postUrl=null,this._jsonColors={}}return n(e,[{key:"mergeColorSettings",value:function t(e){var t=e,i=void 0,o=void 0,n=void 0,a=this.filters,r=void 0,l=void 0;if("String"==typeof e&&(t=JSON.parse(e)),!t.colors)return void console.warn(s.NO_COLOR_SETTINGS);for(i in t.colors)r=i.split("."),a[r[0]]&&a[r[0]].obs.hasOwnProperty(r[1])&&(o=t.colors[i],a[r[0]].obs[r[1]].color=o,a[r[0]].obs[r[1]].hexColor=parseInt(o.replace(/^#/,""),16),a[r[0]].obs[r[1]].colorIsRandom=!1);this._jsonColors=t.colors}},{key:"toggleHandler",value:function i(e){this.toggle(!this.isOpened)}},{key:"close",value:function a(){this.toggle(!1)}},{key:"toggle",value:function l(){var e=arguments.length<=0||void 0===arguments[0]?!0:arguments[0],t=this.filters;return this._node.style.display=e?"block":"none",this.isOpened=e,e?(this._node.colorsTemp={},this.referenz&&""!==this.referenz.value&&t[this.referenz.value]&&(this._node.dropdwn.value=this.referenz.value),this.dropFilterChanged(),void(this.onToggled&&this.onToggled(!0))):void(this.onToggled&&this.onToggled(!1))}},{key:"_makeHeightVisible",value:function d(e){var t=Number(e),i=Math.floor(t),o=1.2*(t-i);return i+o}},{key:"dropFilterChanged",value:function c(){var e=this,t=[],i=void 0,o={0:"no",1:"yes"},n=this._node.dropdwn.value,a=this.filters[n],r=void 0,s=void 0,l=void 0,d=void 0;for(i in a.obs)l=e._node.colorsTemp[n+"."+i]||a.obs[i].color,d="h"===n?e._makeHeightVisible(i):i,t.push("<li data-color='"+l+"' id='liColor_"+n+"."+i+"'><span style='background:"+l+"'> </span>"+(a.tf?o[i]:d)+"&nbsp;</li>");this._node.ulColors.innerHTML=t.join(""),r=this._node.ulColors.getElementsByTagName("LI"),r&&0!==r.length&&(s=r[0],s.className="selected",this._currentOption=s,this._node.colorPickerJoe?this._node.colorPickerJoe.set(s.getAttribute("data-color")):(this._node.colorPickerJoe=colorjoe.rgb(this._node.colorPickerDiv,s.getAttribute("data-color")),this._node.colorPickerJoe.on("change",function(t){e._currentOption.setAttribute("data-color",t.hex()),e._currentOption.getElementsByTagName("SPAN")[0].style.background=t.hex(),e._node.colorsTemp[e._currentOption.id.replace("liColor_","")]=t.hex()})))}},{key:"selectOption",value:function u(e){var t=this,i=e.target,o=void 0,n=void 0,a=void 0;if("LI"===i.tagName&&(o=this._node.ulColors.getElementsByTagName("LI"),"selected"!==i.className)){for(n=0,a=o.length;a>n;n+=1)i!==o[n]&&(o[n].className="");setTimeout(function(){i.className="selected",t._node.colorPickerJoe.set(i.getAttribute("data-color"),!0),t._currentOption=i},150)}}},{key:"saveColors",value:function h(){var e=void 0,t=this._node.colorsTemp,i=this.filters,o={},n=[],a=void 0,r=void 0,s=void 0;for(e in t)a=e.split("."),2===a.length&&(r=t[e],i[a[0]].obs[a[1]].color=r,i[a[0]].obs[a[1]].hexColor=parseInt(r.replace(/^#/,""),16),i[a[0]].obs[a[1]].colorIsRandom=!1,o[a[0]]||(o[a[0]]=!0),n.push({attributeKey:a[0],attributeValue:a[1],hexColor:r}));this.close(),this.onSaved&&this.onSaved(i,t,o),this.postUrl&&(s=new XMLHttpRequest,s.open("POST",this.postUrl),s.setRequestHeader("Content-Type","application/json"),s.onreadystatechange=function(){4===s.readyState&&200===s.status&&console.log(s.responseText)},s.send(JSON.stringify(n)))}},{key:"getColors",value:function p(){var e={},t=void 0,i=void 0,o=this.filters;for(t in o){e[t]={};for(i in o[t].obs)e[t][i]={color:o[t].obs[i].color,colorIsRandom:o[t].obs[i].colorIsRandom}}return e}}]),e}();i.ColorsWidget=l},{"../core/i18labels.js":4,"../utils/dom-utilities.js":12,"../utils/js-helpers.js":13}],3:[function(e,t,i){"use strict";function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(i,"__esModule",{value:!0});var n=function(){function e(e,t){for(var i=0;i<t.length;i++){var o=t[i];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,i,o){return i&&e(t.prototype,i),o&&e(t,o),t}}(),a=e("./i18labels.js"),r=e("../utils/js-helpers.js"),s=e("../utils/dom-utilities.js"),l=function(){function e(t){o(this,e),this.divLoading=t}return n(e,[{key:"loadUrl",value:function t(e){var t=arguments.length<=1||void 0===arguments[1]?"":arguments[1],i=arguments.length<=2||void 0===arguments[2]?null:arguments[2],o=this;return new Promise(function(n,r){function l(e){var t=void 0;try{200===d.status?(t=JSON.parse(d.responseText),n(t)):r(d.statusText)}catch(i){r(a.ERROR_PARSING_JSON+" "+i.description)}}var d=void 0,c=function h(e){o.divLoading&&(o.divLoading.setMessage(e.responseText,!0),o.divLoading.updateLoader(0,1)),console.error(e)},u=function p(e){if(e.lengthComputable){var t=e.loaded/e.total;o.divLoading.updateLoader(t,.5)}};return e?(o.divLoading&&(o.divLoading.show(),o.divLoading.startAnimation(),t&&o.divLoading.setMessage(t)),d=new XMLHttpRequest,s.addEventLnr(d,"load",l),s.addEventLnr(d,"error",c),(o.divLoading||null!==i)&&s.addEventLnr(d,"progress",i||u),d.open("GET",e+(e.indexOf("?")>0?"&":"?")+"t="+1*new Date),void d.send()):void r(a.INVALID_DATA_SOURCE)})}},{key:"generateStructuredData",value:function i(e){function t(e){var t=e.bay,i=e.iBay;i%2===0&&(t=r.pad(i-1,3)),D[e.bay]?D[e.bay]+=1:D[e.bay]=1,w[t]||(w[t]={cells:{},n:0},w.n+=1,w[t].maxD=20,T.push(t)),w[t].cells[e.cell]||(w[t].cells[e.cell]={tiers:{},n:0},w[t].n+=1,L||"00"!==e.cell||(L=!0)),w[t].cells[e.cell].tiers[e.tier]=e,w[t].cells[e.cell].n+=1,N<w[t].n&&(N=w[t].n),e.depth>w[t].maxD&&(w[t].maxD=e.depth),s.tier<"78"?(y.tiers[s.tier]||(y.tiers[s.tier]={h:e.h,accH:0},y.n+=1),e.h>y.tiers[s.tier].h&&(y.tiers[s.tier].h=e.h)):g.tiers[s.tier]||(g.tiers[s.tier]={h:e.h,accH:0},g.n+=1),f[s.tier]?f[s.tier].maxH=Math.max(f[s.tier].maxH,s.h):f[s.tier]={maxH:s.h}}function i(e,t,i){x[e]={name:t,obs:{},tf:i}}function o(e){x.s.obs[e.s]||(x.s.obs[e.s]={c:1,indexes:[]}),x.i.obs[e.i]||(x.i.obs[e.i]={c:1,indexes:[]}),x.r.obs[e.r]||(x.r.obs[e.r]={c:1,indexes:[]}),x.w.obs[e.w]||(x.w.obs[e.w]={c:1,indexes:[]}),x.o.obs[e.o]||(x.o.obs[e.o]={c:1,indexes:[]}),x.d.obs[e.d]||(x.d.obs[e.d]={c:1,indexes:[]}),x.f.obs[e.f]||(x.f.obs[e.f]={c:1,indexes:[]}),x.t.obs[e.t]||(x.t.obs[e.t]={c:1,indexes:[]}),x.x.obs[e.x]||(x.x.obs[e.x]={c:1,indexes:[]}),x.v.obs[e.v]||(x.v.obs[e.v]={c:1,indexes:[]}),x.l.obs[e.l]||(x.l.obs[e.l]={c:1,indexes:[]}),x.h.obs[e.h]||(x.h.obs[e.h]={c:1,indexes:[]}),x.s.obs[e.s].indexes.push(e),x.i.obs[e.i].indexes.push(e),x.r.obs[e.r].indexes.push(e),x.w.obs[e.w].indexes.push(e),x.o.obs[e.o].indexes.push(e),x.d.obs[e.d].indexes.push(e),x.f.obs[e.f].indexes.push(e),x.t.obs[e.t].indexes.push(e),x.x.obs[e.x].indexes.push(e),x.v.obs[e.v].indexes.push(e),x.l.obs[e.l].indexes.push(e),x.h.obs[e.h].indexes.push(e)}var n=void 0,a=void 0,s=void 0,l=void 0,d=void 0,c=void 0,u=0,h=0,p=0,v={},m={},f={},y=void 0,g=void 0,b=void 0,E=void 0,w=void 0,x=void 0,T=[],C=void 0,S=void 0,R=void 0,P=void 0,M=void 0,k=void 0,H=void 0,N=0,B="",L=!1,I=0,D={},O={},j={};if(E=e["3DVesselData"]||e["2DVesselData"],!E)return console.error("No data!. Halting generateStructuredData."),null;for(b={conts:E,info:{contsL:E.length}},w={n:0},y={n:0,tiers:{}},g={n:0,tiers:{}},x={},i("i","Equipment Type",!1),i("s","Status",!0),i("r","Is Reefer",!0),i("w","Is Hazardous",!0),i("t","Is Tank",!0),i("x","Is OOG",!0),i("o","Line Operator",!1),i("d","Port of Discharge",!1),i("f","Port of Load",!1),i("v","Is VGM Weight",!0),i("l","Length",!1),i("h","Height",!1),a=0,n=b.conts.length;n>a;a+=1)s=b.conts[a],s.bay=s.p.substr(0,3),s.cell=s.p.substr(3,2),s.tier=s.p.substr(5,2),s.h=Number(Math.floor(s.h))+5*(s.h-Math.floor(s.h))/6,s.depth=Number(Math.floor(s.l))+5*(s.l-Math.floor(s.l))/6,s.iBay=Number(s.bay),s.iTier=Number(s.tier),s.myJ=a,s.cDash=s.c.replace(/\s/gi,"-"),void 0===s.f&&void 0!==s.ld&&(s.f=s.ld),O["cont_"+s.cDash]=s,t(s),o(s);for(B=_.max(_.keys(w)),a=1,n=Number(B);n>=a;a+=2)C=r.pad(a,3),R=r.pad(a-1,3),w[C]&&(w[C].isBlockStart=!0,D[R]&&(w[C].isBlockStart=!1),w[C].maxCell=_.chain(w[C].cells).keys().sort().last().value());return P=Number(_.min(_.keys(y.tiers))),M=Number(_.min(_.keys(g.tiers))),k=Number(_.max(_.keys(y.tiers))),H=Number(_.max(_.keys(g.tiers))),{data:b,dataStructured:w,dataStructuredKeysArr:T.sort(r.sortNumeric),belowTiers:y,aboveTiers:g,containersIDs:O,numContsByBay:D,allContainerMeshesObj:j,filters:x,iTierMin:P,iTierMinAbove:M,iTierMax:k,iTierMaxAbove:H,tiers:f,maxWidth:N,firstBay:_.min(_.keys(w)),lastBay:B,hasZeroCell:L}}}]),e}();i.DataLoader=l},{"../utils/dom-utilities.js":12,"../utils/js-helpers.js":13,"./i18labels.js":4}],4:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var o="Loading 3D Model...";i.LOADING_DATA=o;var n="Error: Missing data source.";i.INVALID_DATA_SOURCE=n;var a="Error while parsing the JSON file.";i.ERROR_PARSING_JSON=a;var r="Click on colors to change them";i.CLICK_TO_CHANGE_COLORS=r;var s="No color settings found. Will use random.";i.NO_COLOR_SETTINGS=s;var l="Please select the document options";i.PRINTOPTS_TITLE=l;var d="Orientation";i.PRINTOPTS_ORIENTATION=d;var c="Landscape";i.PRINTOPTS_ORIENTATION_LANDSCAPE=c;var u="Portrait";i.PRINTOPTS_ORIENTATION_PORTRAIT=u;var h="Printer DPI";i.PRINTOPTS_DPI=h;var p="Paper Size";i.PRINTOPTS_SIZE=p;var v="GENERATE PDF";i.PRINTOPTS_GO=v;var m="Bays per row";i.PRINTOPTS_PERROW=m;var f="Colour by";i.PRINTOPTS_COLORBY=f;var y="Generating pages, please wait...";i.PRINTOPTS_PAGEPROGRESS=y;var g="Sending pages, please wait...";i.PRINTOPTS_SENDINGPAGES=g;var b="Download PDF";i.PRINTOPTS_DOWNLOAD=b},{}],5:[function(e,t,i){"use strict";function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(i,"__esModule",{value:!0});var n=function(){function e(e,t){for(var i=0;i<t.length;i++){var o=t[i];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,i,o){return i&&e(t.prototype,i),o&&e(t,o),t}}(),a=e("../utils/random-color.js"),r=function(){function e(t){o(this,e),this.models={},this.isoModels={},this.appScene=t}return n(e,[{key:"addIsoModel",value:function t(e){var t=this,i=t.isoModels;i[e.i]||(i[e.i]={d:e.depth,h:e.h,t:e.t})}},{key:"extendSpecs",value:function i(e){var t,i,o,n,r,s,l=this,d=new a.RColor,c,u;for(o in e){r=e[o];for(n in r.obs)s=r.obs[n],c=d.get(!0),u=parseInt(c.replace(/^#/,""),16),s.color=c,s.hexColor=u,s.colorIsRandom=!0}}},{key:"createBaseMaterials",value:function r(e){var t,i,o,n,a,r,s=this,l,d,c,u=this.appScene.renderer3d;for(o in e){a=e[o];for(n in a.obs)r=a.obs[n],c=r.hexColor,d=u.addContainerMaterial(c),r.materialPos=d}}}]),e}();i.ModelsFactory=r},{"../utils/random-color.js":15}],6:[function(e,t,i){"use strict";function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(i,"__esModule",{value:!0});var n=function(){function e(e,t){for(var i=0;i<t.length;i++){var o=t[i];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,i,o){return i&&e(t.prototype,i),o&&e(t,o),t}}(),a=e("../utils/js-helpers.js"),r=e("../utils/dom-utilities.js"),s=e("../text2D/SpriteText2D.js"),l=e("../text2D/textAlign.js"),d=function(){function e(t,i,n){o(this,e),this.scene=null,this.renderer=null,this.camera=null,this.raycaster=new THREE.Raycaster,this.mouseVector=new THREE.Vector2,this.controls=null,this.appScene=t,this.container=t._node,this.width=i,this.height=n,this.frames=0,this._INTERSECTED=null,this.followMouseEvents=!1,this.mouseStart=new THREE.Vector2,this.mouseLastClick=new Date,this._isRendering=!0,this._floatingCamera=!0,this._modelsLoaded={},this.g3Bays={},this.models={},this.maxDepth=0,this.maxWidth=0,this.shipHouse=null,this.simpleDeck=null,this.hatchCover=null,this.hatchCovers={},this.allMaterials=[],this.basicMaterial=new THREE.MeshBasicMaterial({color:16777215,transparent:!0,opacity:.3,wireframe:!0}),this.selectionMaterial=new THREE.MeshStandardMaterial({color:0,side:THREE.DoubleSide,opacity:1,transparent:!1}),this.containersGroup=null;
}return n(e,[{key:"init",value:function t(){function e(e,t,i){var o=new THREE.DirectionalLight(16777215,.3);return o.position.set(e,t,i),o.castShadow=!0,o.shadow.camera.left=-s,o.shadow.camera.right=s,o.shadow.camera.top=s,o.shadow.camera.bottom=-s,o.shadow.camera.far=1600,o.shadow.camera.near=1,o}var t=this,i=void 0,o=void 0,n=void 0,a=void 0,s=800,l=this.appScene.options;if(null===this.container||void 0===this.container)return void console.error("Container is null. Halting.");if(!this.width)return void console.error("Width is null or zero. Halting.");if(!this.height)return void console.error("Height is null or zero. Halting.");this.scene=new THREE.Scene,this.renderer=new THREE.WebGLRenderer({antialias:!0,alpha:!0}),this.renderer.setClearColor(l.colors.background,1),this.renderer.setPixelRatio(window.devicePixelRatio),this.renderer.setSize(this.width,this.height),this.container.divRenderC.appendChild(this.renderer.domElement),this.camera=new THREE.PerspectiveCamera(50,this.width/this.height,1,3e4),this.camera.position.z=l.initialCameraPosition.z,this.camera.position.x=l.initialCameraPosition.x,this.camera.position.y=l.initialCameraPosition.y,this.controls=new THREE.OrbitControls(this.camera,this.renderer.domElement),this.controls.enableDamping=!0,this.controls.dampingFactor=l.dampingFactorOut||.2,this.controls.minPolarAngle=Math.PI/5,this.controls.maxPolarAngle=Math.PI/5*4,this.controls.maxDistance=2*l.initialCameraPosition.z,this.controls.minDistance=l.initialCameraPosition.z/2,this.controls.enableKeys=!1,this.controls.enablePan=!1,this.raycaster=new THREE.Raycaster,this.mouseVector=new THREE.Vector2,n=new THREE.Group,o=e(-s,s,-s),n.add(o),o=e(s,s,-s),n.add(o),o=e(s,s,s),n.add(o),o=e(-s,s,s),n.add(o),o=new THREE.DirectionalLight(16316398,.15),o.position.set(0,-300,-50),n.add(o),this.lightsGroup=n,o=new THREE.AmbientLight(l.colors.sunlight,.7),this.scene.add(o),this.scene.add(n);var d=new THREE.Object3D;this.scene.add(d),this.containersGroup=d,r.addEventLnr(window,"mousemove",function(e){t.mouseVector.x=e.clientX/t.width*2-1,t.mouseVector.y=2*-(e.clientY/t.height)+1})}},{key:"createBay",value:function i(e){var t=this,i=void 0,o=void 0,n=void 0;return t.g3Bays["b"+e]?t.g3Bays["b"+e]:(i=new THREE.Group,i.name="b"+e,i.iBay=Number(e),i.isBlockStart=!1,t.g3Bays["b"+e]=i,t.containersGroup.add(i),i)}},{key:"_addLabelsToBay",value:function d(e,t,i){var o=arguments.length<=3||void 0===arguments[3]?"FWD":arguments[3],n=arguments.length<=4||void 0===arguments[4]?"AFT":arguments[4],a=void 0,r=this.appScene.data.aboveTiers.n,d=this.appScene.options.extraSep,c=this.appScene.options.labelScale||2;a=new THREE.Group,a.name="labels",a.visible=!1,e.labelsCanBeVisible=!0;var u=new s(o,{align:l.center,font:"32px Arial",fillStyle:"#888888"});u.position.z=-15,u.scale.set(c,c,1),a.add(u),u=new s(n,{align:l.center,font:"32px Arial",fillStyle:"#888888"}),u.position.z=60,u.scale.set(c,c,1),a.add(u),e.add(a),e.labels=a,a.position.y=t,a.position.z=i}},{key:"addContainerMaterial",value:function c(e){var t=new THREE.MeshStandardMaterial({color:e,side:THREE.DoubleSide,transparent:!0,opacity:1});return this.allMaterials.push(t),this.allMaterials.length-1}},{key:"createBaseModels",value:function u(e){var t=this,i,o,n,a,r,s,l=this.appScene.data.filters,d,c;for(i in e)o=e[i],n=o.h,r=l.i.obs[i],o.t?(d=new THREE.CylinderGeometry(4,4,o.d,16),c=new THREE.Mesh(d,t.allMaterials[r.materialPos]),d.translate(-4,o.d/2,-4),c.rotation.z=-Math.PI/2,c.rotation.y=-Math.PI/2):(a=new THREE.Shape([new THREE.Vector2(0,0),new THREE.Vector2(0,n),new THREE.Vector2(8,n),new THREE.Vector2(8,0)]),d=new THREE.ExtrudeGeometry(a,{bevelEnabled:!1,steps:1,amount:o.d}),c=new THREE.Mesh(d,t.allMaterials[r.materialPos])),c.materialPos=r.materialPos,c.dynamic=!0,this.models[i]=c}},{key:"create3dContainersFromData",value:function h(e){var t=this,i=e.data,o=e.belowTiers,n=e.aboveTiers,r=e.iTierMin,s=e.iTierMinAbove,l=e.dataStructured,d=e.allContainerMeshesObj,c=e.numContsByBay,u=this.g3Bays,h=this.appScene._node.loadingDiv,p=this.appScene.options.extraSep,v=void 0,m=i.info.contsL,f=void 0,y=void 0,g=void 0,b=void 0,E=void 0,w=void 0,x=void 0,T=void 0,C=void 0,S=void 0,R=void 0,P=void 0,M=void 0,k=0,H=void 0,N=void 0,B=void 0,L=void 0,I=void 0,D=void 0,O=void 0,j=4,A=4-p,F=void 0,V=void 0,z=void 0,W=void 0,G=void 0,U=void 0,Z=void 0,J=[],K=void 0,q=void 0,Q=void 0,Y=void 0,X={},ee=new THREE.MeshStandardMaterial({color:6710886}),te=function ie(e,t){e.p===t.p?0:e.p<t.p?-1:1};for(F=_.max(_.keys(l)),G=l[F].maxD,A=_.reduce(o.tiers,function(e,t){return e+t.h+p},0)+A,K=0,v=1;F>=v;v+=2)y=a.pad(v,3),q=a.pad(v+1,3),Q=a.pad(v-1,3),Y=u["b"+q],l[y]||(l[y]={cells:{},n:0,z:0}),v%2===1&&(k+=22.5+p),l[y].z=k,U=t.createBay(y),U.position.z=k,U.originalZ=k,U.isBlockStart=!0,Y&&(Y.position.z=k,Y.originalZ=k),c[Q]&&(U.isBlockStart=!1),U.isBlockStart&&(K+=1,this._addLabelsToBay(U,n.n*(9.5+p),0)),U.compactBlockNum=K,Y&&(Y.compactBlockNum=K);for(Z=k+G,this.maxDepth=Z,this.maxWidth=e.maxWidth,this.maxCompactBlockNums=K,v=0,m=i.info.contsL;m>v;v+=1)T=i.conts[v],C=t.models[String(T.i)],V=T.iBay,z=Number(T.cell),H=(z%2===0?z/2:-(z+1)/2)*(8+p),W=Number(T.tier),N=W>=78?(W-s)/2*(9.5+p)+j:(W-r)/2*(9.5+p)-A,S=C.clone(),S.materialPos=C.materialPos,S.name="cont_"+T.cDash,S.objRef=T,S.position.x=H,S.position.y=N,S.position.z=0,S.updateMatrix(),S.matrixAutoUpdate=!1,S.isBasic=!1,u["b"+T.bay].add(S),d[T.cDash]=S;t._createShipDeck(),t._createHouse(n.n),t._createHatchCovers(),h.stopAnimation(),setTimeout(function(){h.hide()},500)}},{key:"_createHatchCovers",value:function p(){function e(e){var t=void 0,i=void 0,o=void 0,n=void 0,a=void 0;o=5===e||6===e||9===e?3:4>=e?e:4,t=e/o,i=Math.ceil(t),a=new Array(i);for(var r=0;i>r;r+=1)a[r]=o;return n=Math.ceil((t-Math.floor(t))*o),n>0&&(a[Math.floor(i/2)]=n),a}function t(e,t){var o=void 0,n=void 0,a=void 0,r=e*(8+i)-i;return o=new THREE.Shape([new THREE.Vector2(-r,0),new THREE.Vector2(-r,t),new THREE.Vector2(0,t),new THREE.Vector2(0,0)]),n=new THREE.ExtrudeGeometry(o,{bevelEnabled:!1,steps:1,amount:3}),a=new THREE.Mesh(n,H),a.rotation.x=Math.PI/2,n.translate(8.5+i,0,0),a}var i=this.appScene.options.extraSep,o=this.maxWidth,n=this.maxDepth,r=o*(8+i),s=this.appScene.data.dataStructured,l=this.g3Bays,d=this.appScene.data.lastBay,c=this.appScene.data.hasZeroCell?1:0,u=[],h=void 0,p=void 0,v=void 0,m=void 0,f=void 0,y=[],g=void 0,b=0,E=void 0,w=new THREE.Group,x=void 0,T=void 0,C=void 0,S=void 0,R=void 0,P=void 0,M=void 0,k=void 0,H=new THREE.MeshStandardMaterial({color:6710886}),N=45,B=function V(e){return(e%2===0?e/2:-(e+1)/2)*(8+i)};for(h=1;d+1>=h;h+=2)v=a.pad(h,3),m=l["b"+v],m&&(f=Number(m.compactBlockNum),y[f]?(y[f].posLeft=s[v].n?Math.max(y[f].posLeft,Number(_.max(_.filter(_(s[v].cells).keys(),function(e){return Number(e)%2===0}),function(e){return Number(e)}))):0,y[f].posRight=s[v].n?Math.max(y[f].posRight,Number(_.max(_.filter(_(s[v].cells).keys(),function(e){return Number(e)%2===1}),function(e){return Number(e)}))):0):y[f]={baseBay:m.iBay,cbn:f,cells:s[v].n,maxD:s[v].maxD||0,posLeft:s[v].n?Number(_.max(_.filter(_(s[v].cells).keys(),function(e){return Number(e)%2===0}),function(e){return Number(e)})):0,posRight:s[v].n?Number(_.max(_.filter(_(s[v].cells).keys(),function(e){return Number(e)%2===1}),function(e){return Number(e)})):0},b=f);for(y[1].maxLeftUp=y[1].posLeft,y[1].maxRightUp=y[1].posRight,y[b].maxLeftDown=y[b].posLeft,y[b].maxRightDown=y[b].posRight,h=2,p=b+1;p>h;h+=1)y[h].maxLeftUp=Math.max(y[h-1].maxLeftUp,y[h].posLeft),y[h].maxRightUp=Math.max(y[h-1].maxRightUp,y[h].posRight),y[p-h].maxLeftDown=Math.max(y[p-h+1].maxLeftDown,y[p-h].posLeft),y[p-h].maxRightDown=Math.max(y[p-h+1].maxRightDown,y[p-h].posRight);for(h=1,p=b+1;p>h;h+=1)y[h].maxLeft=Number(Math.min(y[h].maxLeftUp,y[h].maxLeftDown)),y[h].maxRight=Number(Math.min(y[h].maxRightUp,y[h].maxRightDown)),E=Math.max(y[h].maxLeft,y[h].maxRight),M=y[h].maxD?y[h].maxD<=20?22.5:45:22.5,0!==M&&(1===h?u.push({d:M,l:y[h].maxLeft,b:y[h].baseBay,hts:e(E+c)}):y[h].maxLeft===y[h-1].maxLeft&&y[h].maxRight===y[h-1].maxRight&&u[u.length-1].d+(y[h].maxD||45)<=N?u[u.length-1].d+=y[h].maxD||45:u.push({d:M,l:y[h].maxLeft,b:y[h].baseBay,hts:e(E+c)}));for(P=22.5,h=0,p=u.length;p>h;h+=1){T=u[h],k=new THREE.Group,k.name="baseBay-"+T.b,k.baseBay=T.b,this.hatchCovers["b"+a.pad(T.b,3)]=k,S=T.l,R=B(S);for(var L=0,I=T.hts.length;I>L;L+=1)C=T.hts[L],x=t(C,T.d),x.position.x=R-2*i,k.add(x),R-=C*(8+i);k.position.z=P,k.originalZ=P,w.add(k),P+=T.d+2*i}for(v in l)if(m=l[v],m.isBlockStart){if(g=y[m.compactBlockNum],!g.maxD)continue;var D=B(g.maxLeft),O=B(g.maxRight),j=new THREE.Shape([new THREE.Vector2(D+c*(8+i),0),new THREE.Vector2(O,0),new THREE.Vector2(O,g.maxD),new THREE.Vector2(D+c*(8+i),g.maxD)]),A=new THREE.ExtrudeGeometry(j,{bevelEnabled:!1,steps:1,amount:2}),F=new THREE.Mesh(A,H);F.rotation.x=Math.PI/2,F.position.y=1,F.visible=!1,m.add(F),m.hatchC=F}this.scene.add(w),w.position.y=1.5,this.hatchDeck=w}},{key:"_createShipDeck",value:function v(){var e=new THREE.LineBasicMaterial({color:4033704,opacity:1,linewidth:2}),t=this.appScene.options.extraSep,i=this.maxWidth,o=this.maxDepth,n=void 0,a=new THREE.CurvePath,r=void 0,s=void 0,l=i*(8+t)/4;a.add(new THREE.EllipseCurve(4,20,l,3*l,Math.PI,0,!1)),a.add(new THREE.EllipseCurve(4,o,l,.75*l,0,Math.PI,!1)),a.closePath(),r=a.createPointsGeometry(150),s=new THREE.Line(r,e),s.rotation.x=Math.PI/2,this.scene.add(s),this.simpleDeck=s}},{key:"_createHouse",value:function m(e){var t=this.appScene.options.extraSep,i=this.maxWidth,o=this.appScene.data.belowTiers,n=i*(8+t)/2*.9,a=Math.max(1,e)*(9.5+t)+6,r,s,l,d,c=Math.max(1,.7*o.n),u=c*(9.5+t),h=c*(8+t)/2,p,v=new THREE.MeshPhongMaterial({color:6075098,side:THREE.DoubleSide}),m=new THREE.MeshPhongMaterial({color:11184810,side:THREE.DoubleSide});s=new THREE.Shape([new THREE.Vector2(0,-u),new THREE.Vector2(-h,-u),new THREE.Vector2(-n,0),new THREE.Vector2(-n,a),new THREE.Vector2(-n-.25*n,a+10),new THREE.Vector2(-n-.25*n,a+20),new THREE.Vector2(-n,a+20),new THREE.Vector2(-n+.125*i,a+24),new THREE.Vector2(n-.125*i,a+24),new THREE.Vector2(n,a+20),new THREE.Vector2(n+.25*n,a+20),new THREE.Vector2(n+.25*n,a+10),new THREE.Vector2(n,a),new THREE.Vector2(n,0),new THREE.Vector2(h,-u),new THREE.Vector2(0,-u)]),r=new THREE.ExtrudeGeometry(s,{bevelEnabled:!1,steps:1,amount:20}),l=new THREE.Mesh(r,m),l.matrixAutoUpdate=!1,p=new THREE.Object3D,p.name="house",p.add(l),s=new THREE.Shape([new THREE.Vector2(-1.125*n,0),new THREE.Vector2(-1.125*n,7),new THREE.Vector2(1.125*n,7),new THREE.Vector2(1.125*n,0)]),d=new THREE.ShapeGeometry(s),l=new THREE.Mesh(d,v),l.position.y=a+10,l.position.z=-.25,l.matrixAutoUpdate=!1,l.updateMatrix(),p.add(l),l=new THREE.Mesh(d,v),l.position.y=a+10,l.position.z=20.25,l.matrixAutoUpdate=!1,l.updateMatrix(),p.add(l),d=new THREE.SphereGeometry(5,32,32),l=new THREE.Mesh(d,m),l.position.y=a+24,l.position.z=10,l.position.x=n-10,l.matrixAutoUpdate=!1,l.updateMatrix(),p.add(l),d=new THREE.SphereGeometry(5,32,32),l=new THREE.Mesh(d,m),l.position.y=a+24,l.position.z=10,l.position.x=-n+10,l.matrixAutoUpdate=!1,l.updateMatrix(),p.add(l),p.position.x=4,p.position.z=-20,p.visible=!1,this.scene.add(p),this.shipHouse={mesh:p,dropdown:null,currPosBay:0,currPosZ:0}}},{key:"setCameraPosition",value:function f(e,t,i){return this.camera.position.z=i,this.camera.position.x=e,this.camera.position.y=t,this.controls.maxDistance=2*i,this.controls.minDistance=i/2,{x:e,y:t,z:i}}},{key:"resize3DViewer",value:function y(e,t){this.camera&&(this.width=e,this.height=t,this.camera.aspect=e/t,this.camera.updateProjectionMatrix(),this.renderer.setSize(e,t))}},{key:"loadModel",value:function g(e,t,i,o){var n=this,a=this.container,s=a.loadingDiv,l=this.appScene.options,d=void 0,c=void 0,u=void 0,h=void 0,p=void 0,v=void 0,m=void 0,f=function g(e){var t=e.loaded/(e.total||3e6);s.updateLoader(t,.3)},y=function b(e){var t=r.addEventDsptchr("modelLoaded");t.data={model:e},a.dispatchEvent(t),s.updateLoader(1,.5),setTimeout(function(){s.hide()},500)};return new Promise(function(e,a){var r=o.replace(".","_");return n._modelsLoaded[r]?void e(r):(s=n.container.loadingDiv,s.setPercentage(0),s.setMessage("Loading model..."),s.show(),v=new THREE.MTLLoader,v.setBaseUrl(t+"textures/"),v.setPath(t),void v.load(i,function(i){var s=void 0,l=void 0;i.preload(),m=new THREE.OBJLoader,m.setPath(t),m.setMaterials(i),m.load(o,function(t){var i=void 0,o=new THREE.Object3D;t.traverse(function(e){i=new THREE.Mesh(e.geometry,e.material),i.name=e.name,i.receiveShadow=!0,i.castShadow=!0,o.add(i)}),n._modelsLoaded[r]=o,y(),e(r)},f,function(e){window.alert("An error happened loading assets"),console.error(e),a()})}))})}},{key:"animate",value:function b(){function e(){requestAnimationFrame(e),t.controls.update(),t.render()}var t=this;e()}},{key:"render",value:function E(){var e=void 0,t=void 0,i=void 0,o=void 0,n=void 0;if(this._isRendering){if(this.frames+=1,1&this.frames)if(this.raycaster.setFromCamera(this.mouseVector.clone(),this.camera),e=this.raycaster.intersectObjects(this.containersGroup.children,!0),t=e.length,t>1){var a=this.appScene.data.containersIDs;i=e[1].object.name,null!==i&&void 0!==i&&(o=a[i],o&&e[1].object!==this._INTERSECTED&&(this._INTERSECTED&&(this._INTERSECTED.material=this._INTERSECTED.isBasic?this.basicMaterial:this.allMaterials[this._INTERSECTED.materialPos]),this._INTERSECTED=e[1].object,this._INTERSECTED.isBasic||(this._INTERSECTED.material=this.selectionMaterial),this.putInfoWindow(o)))}else this._INTERSECTED&&(this._INTERSECTED.material=this._INTERSECTED.isBasic?this.basicMaterial:this.allMaterials[this._INTERSECTED.materialPos],this._INTERSECTED=null);this.renderer.render(this.scene,this.camera)}}},{key:"putInfoWindow",value:function w(e){this.appScene._infoNode.innerHTML="<small>Position:</small> "+e.p+"<br /><small>ID:</small> "+e.c+"<br /><small>ISO:</small> "+e.i+(e.r?" / Reefer":"")+" <small>Status:</small> "+(e.s?"full":"empty")+"<br /><small>Carrier:</small> "+e.o+"<br /><small>POD:</small> "+e.d+"<br /><small>POL:</small> "+(e.f||"")+" <small>Weight:</small> "+e.m+"MT",this.appScene._bayNode.innerHTML="<small>bay</small> "+e.iBay}}]),e}();i.Renderer3D=d},{"../text2D/SpriteText2D.js":10,"../text2D/textAlign.js":11,"../utils/dom-utilities.js":12,"../utils/js-helpers.js":13}],7:[function(e,t,i){"use strict";function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(i,"__esModule",{value:!0});var n=function(){function e(e,t){for(var i=0;i<t.length;i++){var o=t[i];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,i,o){return i&&e(t.prototype,i),o&&e(t,o),t}}(),a=e("../utils/js-helpers.js"),r=e("../utils/dom-utilities.js"),s=e("../utils/preloader.js"),l=e("./data-loader.js"),d=e("./models-factory.js"),c=e("./i18labels.js"),u=function(){function e(t){var i=arguments.length<=1||void 0===arguments[1]?{}:arguments[1];o(this,e);var n=this,s=1;this.options=a.extend({loaderColor:"#f2f2f2",loaderColorSucess:"#79e3da",sizes:[{name:"Letter",w:8.5,h:11},{name:"Legal",w:8.5,h:14},{name:"A4",w:8.3,h:11.7},{name:"A3",w:11.7,h:16.5}],dpis:[{name:"300 dpi",res:300},{name:"150 dpi",res:150}],padding:{w:.06,h:15},aboveBelowSep:2},i),this._node=function(){var e=void 0,i=void 0,o=void 0,a=void 0,s=void 0,l=void 0,d=void 0,u=void 0,h=void 0,p=void 0,v=void 0,m=void 0,f=void 0,y=void 0,g=void 0,b=void 0,E=[],w=void 0,x=void 0,T="printopts-container-"+Math.round(1e5*Math.random());e=document.createElement("div"),e.className="printopts-container",e.id=T,i=document.createElement("div"),i.className="printopts-form",i.innerHTML="<h2>"+c.PRINTOPTS_TITLE+"</h2>",i.id=T+"-form",e.appendChild(i),o=document.createElement("div"),o.className="printopts-progress",o.id=T+"-progress",e.appendChild(o),w=document.createElement("div"),w.className="printopts-container-top",i.appendChild(w),a=document.createElement("SELECT"),a.id=T+"-dropdwn-orientation",w.appendChild(a),E=[],E.push("<option value='0'>"+c.PRINTOPTS_ORIENTATION_LANDSCAPE+"</option>"),E.push("<option value='1'>"+c.PRINTOPTS_ORIENTATION_PORTRAIT+"</option>"),a.innerHTML=E.join(""),l=document.createElement("SELECT"),l.id=T+"-dropdwn-dpi",w.appendChild(l),E=[];for(g in n.options.dpis)b=n.options.dpis[g],E.push("<option value='"+g+"'>"+b.name+"</option>");l.innerHTML=E.join(""),s=document.createElement("SELECT"),s.id=T+"-dropdwn-sizes",w.appendChild(s),E=[];for(g in n.options.sizes)b=n.options.sizes[g],E.push("<option value='"+g+"'>"+b.name+"</option>");return s.innerHTML=E.join(""),d=document.createElement("SELECT"),d.id=T+"-dropdwn-perrow",w.appendChild(d),u=document.createElement("SELECT"),u.id=T+"-dropdwn-colorby",w.appendChild(u),v=document.createElement("button"),v.innerHTML=c.PRINTOPTS_GO,v.className="save",i.appendChild(v),h=document.createElement("span"),h.innerHTML=" or ",i.appendChild(h),m=document.createElement("button"),m.innerHTML="CANCEL",i.appendChild(m),e.dropdwnOr=a,e.dropdwnSz=s,e.dropdwnDp=l,e.dropdwnRw=d,e.dropdwnClr=u,e.btnSave=v,e.btnCancel=m,e.divForm=i,e.divProgress=o,document.body.appendChild(e),t&&(r.addEventLnr(t,"click",n.toggleHandler.bind(n)),r.addEventLnr(a,"change",n.dropFilterChanged.bind(n)),r.addEventLnr(s,"change",n.dropFilterChanged.bind(n)),r.addEventLnr(l,"change",n.dropFilterChanged.bind(n)),r.addEventLnr(m,"click",n.close.bind(n)),r.addEventLnr(v,"click",n.launchPdfStart.bind(n))),e}(),this.title="",this.btnLaunch=t,this.width=0,this.height=0,this.inchFactor=0,this.lineWidth=1,this.baseUrl="",this.data=null,this.dataLoader=new l.DataLoader(null),this.modelsFactory=null,this.onToggled=null,this.onSaved=null,this.postUrl=null,this._init()}return n(e,[{key:"loadUrl",value:function t(e,i,o){return this.dataLoader.loadUrl(e,i,o)}},{key:"loadData",value:function i(e){return this.dataLoader.generateStructuredData(e)}},{key:"_init",value:function s(){var e=this,t=void 0,i=void 0,o=void 0;this.modelsFactory=new d.ModelsFactory(this)}},{key:"dropFilterChanged",value:function u(){var e=this.options.dpis[this._node.dropdwnDp.value].res,t=this.options.sizes[this._node.dropdwnSz.value],i=void 0,o=void 0,n=void 0,a=void 0,r=this._node.dropdwnRw,s=this.options.padding.w,l=void 0;for(this.width=e*t["1"===this._node.dropdwnOr.value?"w":"h"],this.height=e*t["1"!==this._node.dropdwnOr.value?"w":"h"],i=[],i.push("<option value='1'>"+c.PRINTOPTS_PERROW+": 1</option>"),o=2;9>o&&(a=Math.round(this.width/(o*(1+s))),!(.3*e>a));o+=1)i.push("<option data-w='"+a+"' value='"+o+"'>"+c.PRINTOPTS_PERROW+": "+o+"</option>");r.innerHTML=i.join(""),r.selectedIndex=Math.floor(i.length/2)}},{key:"applyColorsFilter",value:function h(e){var t=[],i=void 0,o=void 0;for(i in e)o=e[i],t.push("<option value='"+i+"'>"+c.PRINTOPTS_COLORBY+": "+o.name+"</option>");this._node.dropdwnClr.innerHTML=t.join("")}},{key:"toggleHandler",value:function p(e){this.toggle(!this.isOpened)}},{key:"close",value:function v(){this.toggle(!1)}},{key:"toggle",value:function m(){var e=arguments.length<=0||void 0===arguments[0]?!0:arguments[0];return this._node.style.display=e?"block":"none",this.isOpened=e,e?(this._node.divForm.style.display="block",this._node.divProgress.style.display="none",this.dropFilterChanged(),void(this.onToggled&&this.onToggled(!0))):void(this.onToggled&&this.onToggled(!1))}},{key:"launchPdfStart",value:function f(){var e=this._node.dropdwnRw.value,t=this.options.dpis[this._node.dropdwnDp.value].res,i=this._node.dropdwnClr.value,o=this.width,n=this.height;this.pdfStart(e,t,o,n,i)}},{key:"pdfStart",value:function y(e,t,i,o,n,s){function l(t){var i=arguments.length<=1||void 0===arguments[1]?f.inchFactor:arguments[1],o=arguments.length<=2||void 0===arguments[2]?!1:arguments[2],r=arguments.length<=3||void 0===arguments[3]?!1:arguments[3],s=document.createElement("canvas"),l=void 0,d=void 0,c=void 0;if(s.width=N*i,s.height=H*i,l=s.getContext("2d"),o?(l.fillStyle="#ffffff",l.strokeStyle="#666666"):(d=g.filters[n].obs[t[n]].color,l.fillStyle=d,l.strokeStyle=a.lightenDarkenColor(d,-30)),l.lineWidth=2*f.lineWidth*i/f.inchFactor,l.rect(0,0,N*i,H*i),l.fill(),l.stroke(),r)return l.beginPath(),l.fillStyle="#666666",l.rect(N*i/9*4,H*i/9*3,N*i/9,H*i/9*3),l.fill(),l.rect(N*i/9*3,H*i/9*4,N*i/9*3,H*i/9),l.fill(),s;if(t.s||(c="e"),t.r&&(c="r"),c){var u=ne*i/f.inchFactor;7>e&&(u+=.2*(8-e)),l.font=14*u+"px Arial",l.textAlign="center",l.fillStyle="#333333",l.fillText(c,4*i,7*i)}switch(t.w&&(l.strokeStyle="#666666",l.lineWidth=1,l.moveTo(0,H*i/2),l.lineTo(N*i/2,0),l.lineTo(N*i,H*i/2),l.lineTo(N*i/2,H*i),l.lineTo(0,H*i/2),l.stroke()),9.5===t.h&&(l.fillStyle="#333333",l.beginPath(),l.moveTo(N*i*3/4,0),l.lineTo(N*i,H*i/3),l.lineTo(N*i/2,H*i/3),l.lineTo(N*i*3/4,0),l.fill()),t.l){case 40:l.fillStyle="#333333",l.beginPath(),l.rect(0,0,N*i/2,1*i),l.fill();break;case 45:l.moveTo(0,0),l.fillStyle="#333333",l.beginPath(),l.arc(0,0,3*i,2*Math.PI,Math.PI),l.fill()}return s}function d(e){var t=arguments.length<=1||void 0===arguments[1]?f.inchFactor:arguments[1],i=arguments.length<=2||void 0===arguments[2]?!1:arguments[2];return l(e,t,i,!0)}function u(e){var t=arguments.length<=1||void 0===arguments[1]?f.inchFactor:arguments[1],i=document.createElement("canvas"),o=void 0,n=void 0,a=void 0,r=e.g,s=N*t,l=H*t,d=H*q*t,c=N*q*t,u=s+2*d,h=l+2*c;return i.width=u,i.height=h,o=i.getContext("2d"),o.fillStyle="#444444",r.indexOf("t")>=0&&(o.beginPath(),o.ellipse(u/2,d,s/2,d,0,Math.PI,2*Math.PI),o.fill()),r.indexOf("l")>=0&&(o.beginPath(),o.ellipse(c,h/2,c,l/2,0,.5*Math.PI,1.5*Math.PI),o.fill()),r.indexOf("r")>=0&&(o.beginPath(),o.ellipse(c+s,h/2,c,l/2,0,1.5*Math.PI,.5*Math.PI),o.fill()),r.indexOf("f")>=0&&(o.beginPath(),o.moveTo(c,d+l/4),o.lineTo(c+s,d+l/4),o.stroke()),r.indexOf("b")>=0&&(o.beginPath(),o.moveTo(c,l+d-l/4),o.lineTo(c+s,l+d-l/4),o.stroke()),r.indexOf("x")>=0&&(o.beginPath(),o.moveTo(c,d),o.lineTo(u-c,h-d),o.moveTo(u-c,d),o.lineTo(c,h-d),o.stroke()),i}function h(t){var i=void 0,o=void 0,n=void 0,r=void 0,s=b[t],c=void 0,h=void 0,p=void 0,v=void 0,m=void 0,y=t,g=void 0,E=Math.round(N/2)*f.inchFactor,w=H*f.inchFactor,T=N*f.inchFactor;h=document.createElement("canvas"),h.width=P+2*K*f.inchFactor,h.height=x*f.inchFactor+2*J*f.inchFactor,p=h.getContext("2d"),s.isBlockStart&&s.maxD>20&&(y+=" ("+a.pad(Number(t)+1,3)+")"),s.isBlockStart||(c=b[a.pad(Number(t)-2,3)],c.maxD>20&&(y+=" ("+a.pad(Number(t)-1,3)+")")),g=ne,7>e&&(g+=.2*(8-e)),p.font=24*g+"px Georgia",p.textAlign="center",p.textBaseline="middle",p.fillText(y,P/2,Math.max(J/2*f.inchFactor,0)),p.font=10*g+"px Arial",p.textAlign="center",p.textBaseline="baseline",p.fillStyle="#666666",p.strokeStyle="#dddddd",p.lineWidth=2*f.lineWidth,p.save(),console.log("Step 1, Bay "+t);for(i in j)v=(j[i]-H+J)*f.inchFactor,p.fillText(a.pad(i,2),K/2*f.inchFactor,(w+6)/2+v),p.fillText(a.pad(i,2),(_.max(O)+N+1.5*K)*f.inchFactor,(w+6)/2+v);for(n in O){m=(O[Number(n)]+K)*f.inchFactor,p.fillText(a.pad(n,2),E+m,(_.min(j)-1.5*J)*f.inchFactor),p.fillText(a.pad(n,2),E+m,(_.max(j)+1.5*J)*f.inchFactor);for(i in j)v=(j[i]-H+J)*f.inchFactor,p.rect(m,v,T,w),p.stroke()}for(n in s.cells){r=s.cells[n];for(i in r.tiers){m=(O[Number(n)]+K)*f.inchFactor,v=(j[Number(i)]-H+J)*f.inchFactor;var C=l(r.tiers[i]);p.drawImage(C,m,v)}}for(n in s.cells){r=s.cells[n];for(i in r.tiers)if(r.tiers[i].g){m=(O[Number(n)]+K)*f.inchFactor,v=(j[Number(i)]-H+J)*f.inchFactor;var C=u(r.tiers[i]);p.drawImage(C,m-Y,v-Q)}}if(!s.isBlockStart&&(s=b[a.pad(Number(t)-2,3)]))for(n in s.cells){r=s.cells[n];for(i in r.tiers)if(!(1&r.tiers[i].iBay)){m=(O[Number(n)]+K)*f.inchFactor,v=(j[Number(i)]-H+J)*f.inchFactor;var C=d(r.tiers[i]);p.drawImage(C,m,v)}}return h}function p(){function t(){R>0&&R%2===0&&(a=document.createElement("canvas"),a.width=1.5*(P+2*K*f.inchFactor),a.height=x*f.inchFactor+2*J*f.inchFactor,r=a.getContext("2d"),r.font=19*y+"px Arial",r.textAlign="left",r.fillStyle="#444444",s=c,d=h,S.push(a))}function i(e,i){i[n]="",r.drawImage(l(i,f.inchFactor*b,!0),s,d),i.g&&r.drawImage(u(i,f.inchFactor*b,!0),s-w,d-E),r.fillText(e,s+14*f.inchFactor,d+8*f.inchFactor),m=Math.round(Math.max(m,r.measureText(e).width)),d+=p,d+p>a.height&&(d=h,s+=c+v+m,m=0,R+=1,t())}var o=void 0,a=void 0,r=void 0,s=0,d=0,c=Math.round(6*f.inchFactor),h=Math.round(J*f.inchFactor*2),p=Math.round(14*f.inchFactor),v=Math.round(18*f.inchFactor),m=0,y=void 0,b=1.25,E=Math.round(H*q*f.inchFactor*b),w=Math.round(N*q*f.inchFactor*b),T=void 0,C=void 0,S=[],R=0;a=document.createElement("canvas"),a.width=1.5*(P+2*K*f.inchFactor),a.height=x*f.inchFactor+2*J*f.inchFactor,r=a.getContext("2d"),S.push(a),y=ne,7>e&&(y+=.2*(8-e)),4>e&&(b=1.2),r.font=19*y+"px Arial",r.textAlign="left",r.fillStyle="#444444",d=h,s=c;for(o in g.filters[n].obs)T=g.filters[n].obs[o],C={s:1},C[n]=o,r.drawImage(l(C,f.inchFactor*b),s,d),r.fillText(o,s+16*f.inchFactor,d+8*f.inchFactor),m=Math.round(Math.max(m,r.measureText(o).width)),d+=p,d+p>a.height&&(d=h,s+=c+v+m,m=0,R+=1,t());return i("Hazardous",{s:1,w:1}),i("Empty",{s:0}),i("Reefer",{s:1,r:1}),i("High-cube",{s:1,h:9.5}),i("40-footer",{s:1,l:40}),i("45-footer",{s:1,l:45}),i("Break Bulk",{s:1,g:"x"}),i("Oversize Top",{s:1,g:"t"}),i("Oversize Left",{s:1,g:"l"}),i("Oversize Right",{s:1,g:"r"}),i("Oversize Front",{s:1,g:"f"}),i("Oversize Back",{s:1,g:"b"}),S}function v(){var e=f.postUrl,t=void 0,i=void 0,o=void 0,a=void 0,s=void 0,l=void 0,d=function h(e){console.error(e),Z&&(Z.innerHTML="An error has ocurred.")},u=function p(e){if(e.lengthComputable){var t=Math.round(100*e.loaded/e.total);Z.innerHTML=e.loaded<e.total?t+"%":"Finishing, please wait..."}};for(o="0"===f._node.dropdwnOr.value,i={title:f.title,numImages:F.length,pageSize:f.options.sizes[f._node.dropdwnSz.value].name,pageSizeW:f.options.sizes[f._node.dropdwnSz.value][o?"h":"w"],pageSizeH:f.options.sizes[f._node.dropdwnSz.value][o?"w":"h"]-1,pageOrientation:o?"L":"P",filterBy:c.PRINTOPTS_COLORBY+": "+g.filters[n].name,vesselName:f.metaData.vesselName,vesselCallSign:f.metaData.vesselCallSign,sender:f.metaData.sender,recipient:f.metaData.recipient,placeOfDeparture:f.metaData.placeOfDeparture,voyageNumber:f.metaData.voyageNumber,footerLeft:f.metaData.footerLeft,footerRight:f.metaData.footerRight},a=0,s=F.length;s>a;a+=1)i["page_"+a]=F[a].toDataURL("image/png");t=jQuery.ajax({url:e,type:"POST",data:i,timeout:72e5}),Z&&t.uploadProgress(u),t.fail(d),t.done(function(e){console.log(e),e.download?(Z.innerHTML="<a href='"+f.baseUrl+e.download+"' target='_blank'>Download PDF</a><br /><br />",l=document.createElement("button"),l.innerHTML="Close this window",r.addEventLnr(l,"click",f.close.bind(f)),Z.appendChild(l)):Z.innerHTML="An error has ocurred."})}function m(){var e=void 0,t=void 0,i=void 0,o=[],n=void 0,r=void 0,s=void 0,l=void 0;for(e=0,t=E.length;t>e;e+=1)r=E[e],o.push(r),s=Number(r),n=b[r],i=e+1,(n.isBlockStart&&t>i&&Number(E[i])!==s+2||i===t)&&(l=a.pad(s+2,3),o.push(l),b[l]={n:0,maxD:n.maxD,isBlockStart:!1,cells:{},maxCell:n.maxCell});E=o}var f=this,y=this.options.aboveBelowSep,g=this.data,b=_.clone(g.dataStructured),E=_.clone(g.dataStructuredKeysArr),w=g.hasZeroCell,x=void 0,T=void 0,C=void 0,S=void 0,R=[0],P=void 0,M=void 0,k=void 0,H=8,N=8,B=void 0,L=f.options.padding.w,I=void 0,D=void 0,O={},j={},A=0,F=[],V=void 0,z=void 0,W=void 0,G=void 0,U=this._node.divForm,Z=this._node.divProgress,J=5,K=5,q=.25,Q=void 0,Y=void 0,X=void 0,ee=void 0,te=void 0,ie=void 0,oe=void 0,ne=1;for(m(),U&&(U.style.display="none"),Z&&(Z.style.display="block",Z.innerHTML=c.PRINTOPTS_PAGEPROGRESS),x=(g.belowTiers.n+g.aboveTiers.n)*H+2*y+2*J,T=g.maxWidth*N+2*K,P=Math.floor(i/(e*(1+L))),B=Math.floor(P*L),this.lineWidth=Math.round(t/300),this.inchFactor=P/T,ne=t/300,Q=H*q*f.inchFactor,Y=N*q*f.inchFactor,C=1;e>C;C+=1)R[C]=R[C-1]+P+B;M=(x+H)*this.inchFactor,k=M+f.options.padding.h*this.inchFactor,X=P*e+B*(e-1),te=Math.min(Math.floor(o/k),Math.ceil(E.length/e)),ee=te*M+(te-1)*f.options.padding.h*this.inchFactor,ie=Math.round((o-ee)/2),oe=Math.round((i-X)/2),I=Number(_.max(b,function(e){return e.maxCell}).maxCell),D=(I+(w?1:0))*N;var ae=0,re=D-N;for(C=I,S=w?0:1;C>=S;C-=1)C%2===0?(O[C]=ae,ae+=N):(O[C]=re,re-=N);for(A=0,C=g.iTierMin,S=g.iTierMax;S>=C;C+=2)j[C]=x-A,A+=H;for(A+=2*y,C=g.iTierMinAbove,S=g.iTierMaxAbove;S>=C;C+=2)j[C]=x-A,A+=H;V=document.createElement("canvas"),V.width=i,V.height=o,z=V.getContext("2d"),G=0,setTimeout(function(){for(var t=0,n=E.length;n>t;t+=1){var a=E[t];if(a){var r=h(E[t]);if(z.drawImage(r,R[t%e]+oe,G+ie),((t+1)%e===0||t+1===n)&&(G+=k,G+k>o||t+1===n))if(F.push(V),n>t+1)V=document.createElement("canvas"),V.width=i,V.height=o,z=V.getContext("2d"),G=0;else{(t+1)%e!==0&&(G-=k);for(var s=p(),l=void 0,d=0,u=s.length;u>d;d+=1)l=t+d+1,G+k>o&&(V=document.createElement("canvas"),V.width=i,V.height=o,z=V.getContext("2d"),G=0,F.push(V)),z.drawImage(s[d],Math.round(R[l%e]+oe),Math.round(G+ie)),l%e===e&&(G+=k)}}}Z.innerHTML=c.PRINTOPTS_SENDINGPAGES,v()},50),window.pagess=F}},{key:"setTitle",value:function g(e,t,i){var o=(e?e:"")+(t?" / "+t:"")+(i?" / "+i:"");o&&(this.title=o)}},{key:"setMetaData",value:function b(e,t,i,o,n,a,r,s){this.metaData={vesselName:e,vesselCallSign:t,sender:i,recipient:o,placeOfDeparture:n,voyageNumber:a,footerLeft:r,footerRight:s}}}]),e}();i.VesselsApp2D=u},{"../utils/dom-utilities.js":12,"../utils/js-helpers.js":13,"../utils/preloader.js":14,"./data-loader.js":3,"./i18labels.js":4,"./models-factory.js":5}],8:[function(e,t,i){"use strict";function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(i,"__esModule",{value:!0});var n=function(){function e(e,t){for(var i=0;i<t.length;i++){var o=t[i];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,i,o){return i&&e(t.prototype,i),o&&e(t,o),t}}(),a=e("../utils/js-helpers.js"),r=e("../utils/dom-utilities.js"),s=e("../utils/preloader.js"),l=e("./renderer.js"),d=e("./data-loader.js"),c=e("./models-factory.js"),u=e("./i18labels.js"),h=function(){function e(t,i,n,r,l){o(this,e);var c=this,u=a.getQueryParams(),h=1.1;this.options=a.extend({extraSep:.5,loaderColor:"#f2f2f2",loaderColorSucess:"#79e3da",colors:{background:13823736,sunlight:14869230},dampingFactorOut:.2,dampingFactorIn:.75,initialCameraPosition:{x:0,y:0,z:100},labelScale:8,screenshots:{width:600,height:600,format:"png",transparent:!0}},l),this.width=0,this.height=0,this._titleNode=i,this._bayNode=r,this._infoNode=n,this._node=function p(){var e=void 0,i=void 0,o=void 0,n=void 0,a="app3d-container-"+Math.round(1e5*Math.random());return e=document.createElement("div"),e.className="app3d-container",e.id=a,i=document.createElement("div"),i.className="app3d-render-container",i.id=a+"-render",e.appendChild(i),e.divRenderC=i,o=document.getElementById("app-3d-loading-div"),o||(o=document.createElement("div"),o.className="app3d-loading-div",o.id=a+"-loading-div",e.appendChild(o)),n=document.getElementById("app-3d-loading-div-text"),n||(n=document.createElement("div"),n.className="app3d-loading-div-text",n.id=a+"-loading-text",o.appendChild(n)),e.loadingDiv=new s(o,n,100,c.options,"img-loader-logo"),t.appendChild(e),e}(),this.initialBay=u.bay,this.data=null,this.dataLoader=new d.DataLoader(this._node.loadingDiv),this.renderer3d=null,this.modelsFactory=null,this._init()}return n(e,[{key:"loadUrl",value:function t(e,i,o){return this.dataLoader.loadUrl(e,i,o)}},{key:"loadData",value:function i(e){return this.dataLoader.generateStructuredData(e)}},{key:"_init",value:function u(){var e=this,t=void 0,i=void 0,o=void 0,n=this._node,a=Detector.canvas&&Detector.webgl;return a?(this.updateSize(),this.renderer3d=new l.Renderer3D(this,this.width,this.height),this.renderer3d.init(),this.renderer3d.animate(),this.modelsFactory=new c.ModelsFactory(this),void r.addEventLnr(window,"resize",function(){e.updateSize()})):(n.loadingDiv.show(),void n.loadingDiv.setMessage(n.parentNode.getAttribute(window.WebGLRenderingContext?"data-webgl":"data-gpu")))}},{key:"updateHtmlTitle",value:function h(e,t,i){var o=this,n=void 0;
o._titleNode&&(n=(e?e:"")+(t?" / "+t:"")+(i?" / "+i:""),n?(o._titleNode.innerHTML=n,document.title=n+" / "+document.title):o._titleNode.style.display="none")}},{key:"getDimensions",value:function p(){return{width:this.width,height:this.height}}},{key:"_setDimensions",value:function v(e,t){this.width=e,this.height=t}},{key:"updateSize",value:function m(){var e=void 0,t=void 0,i=void 0,o=void 0,n=void 0,a=void 0;e=this._node,t=e.parentNode,null!==t&&void 0!==t&&(o=this.getDimensions(),n=t.offsetWidth,a=t.offsetHeight,o.width===n&&o.height===a||(e.style.width=n+"px",e.style.height=a+"px",this.renderer3d&&this.renderer3d.resize3DViewer(n,a),this._setDimensions(n,a),i=r.addEventDsptchr("resize"),this._node.dispatchEvent(i)))}},{key:"pauseRendering",value:function f(){this.renderer3d&&(this.renderer3d._isRendering=!1)}},{key:"resumeRendering",value:function y(){this.renderer3d&&(this.renderer3d._isRendering=!0)}},{key:"toggleRendering",value:function g(){var e=arguments.length<=0||void 0===arguments[0]?!0:arguments[0];this.renderer3d&&(this.renderer3d._isRendering=!!e)}},{key:"generateScreenshot",value:function b(){var e=arguments.length<=0||void 0===arguments[0]?this.options.screenshots.width:arguments[0],t=arguments.length<=1||void 0===arguments[1]?this.options.screenshots.height:arguments[1],i=arguments.length<=2||void 0===arguments[2]?this.options.screenshots.format:arguments[2],o=arguments.length<=3||void 0===arguments[3]?this.options.screenshots.transparent:arguments[3];return data}}]),e}();i.VesselsApp3D=h},{"../utils/dom-utilities.js":12,"../utils/js-helpers.js":13,"../utils/preloader.js":14,"./data-loader.js":3,"./i18labels.js":4,"./models-factory.js":5,"./renderer.js":6}],9:[function(e,t,i){"use strict";function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function n(e){var t=r[e];if(!t){var i=document.getElementsByTagName("body")[0],o=document.createElement("div"),n=document.createTextNode("span");o.appendChild(n),o.setAttribute("style","font:"+e+";position:absolute;top:0;left:0"),i.appendChild(o),t=o.offsetHeight,r[e]=t,i.removeChild(o)}return t}var a=function(){function e(e,t){for(var i=0;i<t.length;i++){var o=t[i];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,i,o){return i&&e(t.prototype,i),o&&e(t,o),t}}(),r={},s=function(){function e(){o(this,e),this.textWidth=null,this.textHeight=null,this.canvas=document.createElement("canvas"),this.canvas.width=128,this.canvas.height=128,this.ctx=this.canvas.getContext("2d")}return a(e,[{key:"drawText",value:function t(e,i){return this.ctx.font=i.font,this.textWidth=Math.ceil(this.ctx.measureText(e).width),this.textHeight=n(this.ctx.font),this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height),this.ctx.fillStyle=i.fillStyle,this.ctx.fillRect(0,0,this.canvas.width,this.canvas.height),this.ctx.font=i.font,this.ctx.fillStyle="#000",this.ctx.textAlign="center",this.ctx.textBaseline="middle",this.ctx.fillText(e,this.canvas.width/2,this.canvas.height/2),this.canvas}},{key:"width",get:function i(){return this.canvas.width}},{key:"height",get:function r(){return this.canvas.height}}]),e}();t.exports=s},{}],10:[function(e,t,i){"use strict";function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function n(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var a=function(){function e(e,t){for(var i=0;i<t.length;i++){var o=t[i];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,i,o){return i&&e(t.prototype,i),o&&e(t,o),t}}(),r=function c(e,t,i){for(var o=!0;o;){var n=e,a=t,r=i;o=!1,null===n&&(n=Function.prototype);var s=Object.getOwnPropertyDescriptor(n,a);if(void 0!==s){if("value"in s)return s.value;var l=s.get;if(void 0===l)return;return l.call(r)}var d=Object.getPrototypeOf(n);if(null===d)return;e=d,t=a,i=r,o=!0,s=d=void 0}},s=e("./textAlign.js"),l=e("./CanvasText.js"),d=function(e){function t(){var e=arguments.length<=0||void 0===arguments[0]?"":arguments[0],i=arguments.length<=1||void 0===arguments[1]?{}:arguments[1];o(this,t),r(Object.getPrototypeOf(t.prototype),"constructor",this).call(this),this._font=i.font||"30px Arial",this._fillStyle=i.fillStyle||"#FFFFFF",this.canvas=new l,this.align=i.align||s.center,this.antialias=!0,this.text=e}return n(t,e),a(t,[{key:"updateText",value:function i(){this.canvas.drawText(this._text,{font:this._font,fillStyle:this._fillStyle}),this.cleanUp(),this.texture=new THREE.Texture(this.canvas.canvas),this.texture.needsUpdate=!0,this.applyAntiAlias(),this.material?this.material.map=this.texture:this.material=new THREE.SpriteMaterial({map:this.texture}),this.sprite||(this.sprite=new THREE.Sprite(this.material),this.geometry=this.sprite.geometry,this.add(this.sprite))}},{key:"cleanUp",value:function d(){this.texture&&this.texture.dispose()}},{key:"applyAntiAlias",value:function c(){this.antialias===!1&&(this.texture.magFilter=THREE.NearestFilter,this.texture.minFilter=THREE.LinearMipMapLinearFilter)}},{key:"width",get:function u(){return this.canvas.textWidth}},{key:"height",get:function h(){return this.canvas.textHeight}},{key:"text",get:function p(){return this._text},set:function v(e){this._text!==e&&(this._text=e,this.updateText())}},{key:"font",get:function m(){return this._font},set:function f(e){this._font!==e&&(this._font=e,this.updateText())}},{key:"fillStyle",get:function y(){return this._fillStyle},set:function g(e){this._fillStyle!==e&&(this._fillStyle=e,this.updateText())}}]),t}(THREE.Object3D);t.exports=d},{"./CanvasText.js":9,"./textAlign.js":11}],11:[function(e,t,i){"use strict";t.exports={center:new THREE.Vector2(0,0),left:new THREE.Vector2(1,0),topLeft:new THREE.Vector2(1,-1),topRight:new THREE.Vector2(-1,-1),right:new THREE.Vector2(-1,0),bottomLeft:new THREE.Vector2(1,1),bottomRight:new THREE.Vector2(-1,1)}},{}],12:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var o=function s(e){return e&&e.tagName&&("textarea"===e.tagName.toLowerCase()||"input"===e.tagName.toLowerCase()&&"text"===e.type.toLowerCase())};i.isInputOrTextarea=o;var n=function l(e){return"object"==typeof HTMLElement?id instanceof HTMLElement:"object"==typeof id&&1===id.nodeType&&"string"==typeof id.nodeName};i.isHtmlNode=n;var a=function d(e,t,i){window.attachEvent?(e["e"+t+i]=i,e[t+i]=function(){e["e"+t+i](window.event)},e.attachEvent("on"+t,e[t+i])):e.addEventListener(t,i,!1)};i.addEventLnr=a;var r=function c(e){if(window.Event&&"function"==typeof window.Event)return new Event(e);var t=document.createEvent("Event");return t.initEvent(e,!0,!0),t};i.addEventDsptchr=r},{}],13:[function(e,t,i){"use strict";function o(e,t,i){e?t.apply(null,arguments):i.apply(null,arguments)}function n(e,t){var i=!1;"#"==e[0]&&(e=e.slice(1),i=!0);var o=parseInt(e,16),n=(o>>16)+t;n>255?n=255:0>n&&(n=0);var a=(o>>8&255)+t;a>255?a=255:0>a&&(a=0);var r=(255&o)+t;return r>255?r=255:0>r&&(r=0),(i?"#":"")+(r|a<<8|n<<16).toString(16)}Object.defineProperty(i,"__esModule",{value:!0}),i.callOnCondition=o,i.lightenDarkenColor=n;var a=function v(e){return Array.isArray?Array.isArray(e):e instanceof Array};i.isArray=a;var r=function m(e,t){var i=void 0,o=JSON.parse(JSON.stringify(e));if(t)for(i in t)Object.prototype.hasOwnProperty.call(t,i)&&Object.prototype.hasOwnProperty.call(o,i)&&(o[i]=t[i]);return o};i.extend=r;var s=function f(e,t){return e-t};i.sortNumeric=s;var l=function y(e){var t=arguments.length<=1||void 0===arguments[1]?!0:arguments[1],i=arguments.length<=2||void 0===arguments[2]?!0:arguments[2],o=e;return t&&(o=o.replace(/^\s\s*/,"")),i&&(o=o.replace(/\s\s*$/,"")),o};i.trimString=l;var d=function g(e){var t=void 0,i=void 0,o=new Set;for(t=0,i=e.length;i>t;t+=1){var n=l(e[t]);o.has(n)||o.add(n)}return ouputSet};i.arrayToSet=d;var c=function b(e,t){var i=void 0,o=[];for(i in e)o.push(i);return t&&(o=o.sort(s)),o};i.objKeysToArray=c;var u=function E(e){var t=Number(e).toString(16);return t="000000".substr(0,6-t.length)+t,t.toUpperCase()};i.decimalToHex=u;var h=function w(e,t){var i="000"+String(e);return i.substr(i.length-t)};i.pad=h;var p=function x(){for(var e=document.location.search.split("+").join(" "),t={},i=void 0,o=/[?&]?([^=]+)=([^&]*)/g;i=o.exec(e);)t[decodeURIComponent(i[1])]=decodeURIComponent(i[2]);return t};i.getQueryParams=p},{}],14:[function(e,t,i){"use strict";function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(i,"__esModule",{value:!0});var n=function(){function e(e,t){for(var i=0;i<t.length;i++){var o=t[i];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,i,o){return i&&e(t.prototype,i),o&&e(t,o),t}}(),a=function(){function e(t,i,n,a,r,s){void 0===t&&(t=mandatory()),o(this,e);var l=void 0;null!==t&&void 0!==t&&(this.node=t,l=document.createElement("canvas"),this.messages=i,this.canv=l,this.ctx=l.getContext("2d"),this.loadCurrent=0,this.radius=n,this.canv.width=Math.round(2*n),this.canv.height=Math.round(2*n),this.setPixelRatio(),this.opts=a,this.node.appendChild(l),this.image=r?document.getElementById(r):null,s&&this.setMessage(s))}return n(e,[{key:"rectLoader",value:function t(){var e=this.loadCurrent,t=this.ctx,i=this.radius,o=2*i,n=Math.round(i/2),a=2*e*Math.PI,r=this.opts;t.clearRect(0,0,o,o),t.beginPath(),t.arc(i,i,n,0,2*Math.PI,!1),t.fillStyle=r.loaderColor,t.fill(),t.lineWidth=1,t.strokeStyle=r.loaderColor,t.stroke(),t.beginPath(),t.arc(i,i,Math.round(n/2),0,a,!1),t.lineWidth=n,t.strokeStyle=r.loaderColorSucess,t.stroke(),this.image&&t.drawImage(this.image,n,n,i,i)}},{key:"setPixelRatio",value:function i(){var e=void 0,t=void 0,i=this.ctx,o=window.devicePixelRatio||1,n=i.webkitBackingStorePixelRatio||i.mozBackingStorePixelRatio||i.msBackingStorePixelRatio||i.oBackingStorePixelRatio||i.backingStorePixelRatio||1,a=o/n;o!==n&&(e=this.canv.width,t=this.canv.height,this.canv.width=e*a,this.canv.height=t*a,this.canv.style.width=e+"px",this.canv.style.height=t+"px",this.ctx.scale(a,a))}},{key:"setMessage",value:function a(e){var t=arguments.length<=1||void 0===arguments[1]?!1:arguments[1];this.messages&&(this.messages.innerHTML=e,this.messages.style.color=t?"red":"")}},{key:"updateLoader",value:function r(e,t){var i=this;i.node&&TweenLite.to(i,t,{loadCurrent:e,ease:Power1.easeInOut,onUpdate:i.rectLoader,onUpdateScope:i})}},{key:"startAnimation",value:function s(){this.node&&(this.rectLoader(),this.updateLoader(.4,2))}},{key:"stopAnimation",value:function l(){this.node&&this.updateLoader(1,.25)}},{key:"setPercentage",value:function d(e){this.node&&(this.loadCurrent=e,this.rectLoader())}},{key:"show",value:function c(){this.node&&(this.node.style.display="block")}},{key:"hide",value:function u(){this.node&&(this.node.style.display="none")}}],[{key:"mandatory",value:function h(){throw new Error("Missing parameter")}}]),e}();i["default"]=a,t.exports=i["default"]},{}],15:[function(e,t,i){"use strict";function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(i,"__esModule",{value:!0});var n=function(){function e(e,t){for(var i=0;i<t.length;i++){var o=t[i];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,i,o){return i&&e(t.prototype,i),o&&e(t,o),t}}(),a=function(){function e(){o(this,e),this.hue=Math.random(),this.goldenRatio=.618033988749895,this.hexwidth=2}return n(e,[{key:"hsvToRgb",value:function t(e,i,o){var n=Math.floor(6*e),a=6*e-n,r=o*(1-i),s=o*(1-a*i),l=o*(1-(1-a)*i),d=255,c=255,u=255;switch(n){case 0:d=o,c=l,u=r;break;case 1:d=s,c=o,u=r;break;case 2:d=r,c=o,u=l;break;case 3:d=r,c=s,u=o;break;case 4:d=l,c=r,u=o;break;case 5:d=o,c=r,u=s}return[Math.floor(256*d),Math.floor(256*c),Math.floor(256*u)]}},{key:"padHex",value:function i(e){return e.length>this.hexwidth?e:new Array(this.hexwidth-e.length+1).join("0")+e}},{key:"get",value:function a(e,t,i){this.hue+=this.goldenRatio,this.hue%=1,"number"!=typeof t&&(t=.5),"number"!=typeof i&&(i=.95);var o=this.hsvToRgb(this.hue,t,i);return e?"#"+this.padHex(o[0].toString(16))+this.padHex(o[1].toString(16))+this.padHex(o[2].toString(16)):o}}]),e}();i.RColor=a},{}]},{},[1]);